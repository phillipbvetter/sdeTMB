[{"path":[]},{"path":"/TODO.html","id":"prediction-function-without-data-update","dir":"","previous_headings":"","what":"Prediction function without data update","title":"add_parameters","text":"moment diff eqs simulation (stochastic!)","code":""},{"path":[]},{"path":"/TODO.html","id":null,"dir":"","previous_headings":"","what":"add_parameters","title":"add_parameters","text":"doesnt remove fixed parameter recalling add_parameters without NA’s. need update ","code":""},{"path":[]},{"path":"/articles/construct_nll.html","id":"simulate-from-the-ornstein-uhlenbeck-process","dir":"Articles","previous_headings":"","what":"Simulate from the Ornstein-Uhlenbeck process","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"use common Ornstein-Uhlenbeck process showcase use construct_nll. \\[ \\mathrm{d}X_{t} = \\theta (\\mu - X_{t}) \\, \\mathrm{d}t \\, + \\sigma_{X} \\, \\mathrm{d}B_{t} \\] \\[ Y_{t_{k}} = X_{t_{k}} + e_{t_{k}}, \\qquad e_{t_{k}} \\sim \\mathcal{N}\\left(0,\\sigma_{Y}^{2}\\right)   \\] first create data simulating process","code":"# Simulate data using Euler Maruyama set.seed(10) theta=10; mu=1; sigma_x=1; sigma_y=1e-1 #  dt.sim = 1e-3 t.sim = seq(0,1,by=dt.sim) dw = rnorm(length(t.sim)-1,sd=sqrt(dt.sim)) x = 3 for(i in 1:(length(t.sim)-1)) {   x[i+1] = x[i] + theta*(mu-x[i])*dt.sim + sigma_x*dw[i] }  # Extract observations and add noise dt.obs = 1e-2 t.obs = seq(0,1,by=dt.obs) y = x[t.sim %in% t.obs] + sigma_y * rnorm(length(t.obs))  # Create data .data = data.frame(   t = t.obs,   y = y )"},{"path":"/articles/construct_nll.html","id":"construct-model-object","dir":"Articles","previous_headings":"","what":"Construct model object","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"now construct sdeTMB model object","code":"# Create model object obj = sdeTMB$new()  # Set name of model (and the created .cpp file) obj$set_modelname(\"ornstein_uhlenbeck\")  # Add system equations obj$add_systems(   dx ~ theta * (mu-x) * dt + sigma_x*dw )  # Add observation equations obj$add_observations(   y ~ x )  # Set observation equation variances obj$add_observation_variances(   y ~ sigma_y^2 )  # Specify algebraic relations obj$add_algebraics(   theta ~ exp(logtheta),   sigma_x ~ exp(logsigma_x),   sigma_y ~ exp(logsigma_y) )  # Specify parameter initial values and lower/upper bounds in estimation obj$add_parameters(   logtheta   = log(c(initial = 5,    lower = 0,    upper = 20)),   mu         = c(    initial = 0,    lower = -10,  upper = 10),   logsigma_x = log(c(initial = 1e-1, lower = 1e-5, upper = 5)),   logsigma_y = log(c(initial = 1e-1, lower = 1e-5, upper = 5)) )  # Set initial state mean and covariance obj$set_initial_state(list(x[1], 1e-1*diag(1)))"},{"path":"/articles/construct_nll.html","id":"estimation","dir":"Articles","previous_headings":"","what":"Estimation","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"principle ready call estimate method run optimization scheme using built-optimization uses stats::nlminb .e. Inside package optimise objective function respect fixed parameters using construction function handlers TMB::MakeADFun parsing stats::nlminb .e.","code":"fit = obj$estimate(.data) ## Building model... ## Checking data... ## Constructing objective function and derivative tables... ## ...took: 0.01 seconds. ## Minimizing the negative log-likelihood... ##   0:     915.71828:  1.60944  0.00000 -2.30259 -2.30259 ##   1:     70.083379:  1.05724 0.615164 -1.83518 -1.98924 ##   2:     30.516529:  1.46070 0.571027 -1.52307 -1.13026 ##   3:     26.485474:  1.20713  1.44110 -1.25632 -1.45818 ##   4:    0.69753098:  1.16530  1.06092 -0.940764 -1.52249 ##   5:    -29.578711:  1.69151 0.929750 0.631226 -2.63369 ##   6:    -32.641765:  1.71651 0.927264 0.457807 -2.65530 ##   7:    -33.691413:  1.81987 0.910287 0.321691 -2.61438 ##   8:    -35.580965:  2.12802 0.855363 0.305584 -2.45172 ##   9:    -36.903805:  2.77032  1.08837 0.132724 -2.06057 ##  10:    -38.137542:  2.76625  1.07544 0.111198 -2.16627 ##  11:    -38.547917:  2.74970  1.08203 0.118075 -2.27330 ##  12:    -38.554807:  2.65268  1.08157 0.166259 -2.28262 ##  13:    -38.566248:  2.68392  1.04390 0.156325 -2.30410 ##  14:    -38.650018:  2.72971  1.07243 0.162998 -2.30421 ##  15:    -38.663639:  2.74937  1.07694 0.196589 -2.30768 ##  16:    -38.668540:  2.75909  1.07748 0.191454 -2.31395 ##  17:    -38.668766:  2.75714  1.07641 0.192447 -2.31609 ##  18:    -38.668775:  2.75777  1.07654 0.193094 -2.31661 ##  19:    -38.668775:  2.75779  1.07654 0.193117 -2.31663 ##  20:    -38.668775:  2.75779  1.07654 0.193117 -2.31663 ##   Optimization finished!: ##             Elapsed time: 0.005 seconds. ##             The objective value is: -3.866878e+01 ##             The maximum gradient component is: 1.8e-07 ##             The convergence message is: both X-convergence and relative convergence (5) ##             Iterations: 20 ##             Evaluations: Fun: 25 Grad: 21 ##             See stats::nlminb for available tolerance/control arguments. ## Returning results... ## Finished! nll = TMB::MakeADFun(...) opt = nlminb(start=nll$par, objective=nll$fn, grad=nll$gr, hessian=nll$he)"},{"path":"/articles/construct_nll.html","id":"extract-function-handlers","dir":"Articles","previous_headings":"","what":"Extract function handlers","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"construct_nll method allows retrieve nll object. function takes arguments similar estimate. initial parameters (supplied user) stored objective function can evaluted gradient can evaluted hessian can evaluted can now use optimize function using e.g. stats::optim instead.","code":"nll = obj$construct_nll(.data) ## Building model... ## Checking data... ## Constructing objective function... ## Succesfully returned function handlers nll$par ##   logtheta         mu logsigma_x logsigma_y  ##   1.609438   0.000000  -2.302585  -2.302585 nll$fn(nll$par) ## [1] 915.7183 nll$gr(nll$par) ##          [,1]      [,2]      [,3]      [,4] ## [1,] 1413.301 -1574.451 -1196.276 -801.9666 nll$he(nll$par) ##           [,1]       [,2]       [,3]       [,4] ## [1,]  2184.127 -2837.6171 -1639.8825 -1194.9684 ## [2,] -2837.617  1643.7843  2259.6676   892.1926 ## [3,] -1639.882  2259.6676   915.3926  1486.2728 ## [4,] -1194.968   892.1926  1486.2728   306.5493"},{"path":"/articles/construct_nll.html","id":"extract-parameter-lowerupper-bounds","dir":"Articles","previous_headings":"","what":"Extract parameter lower/upper bounds","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"can extract parameter bounds specified calling add_parameters() method using get_parameters method (note nll$par pars$initial identical).","code":"pars = obj$get_parameters() print(pars) ##            type   estimate   initial     lower     upper ## logtheta   free  2.7577902  1.609438      -Inf  2.995732 ## mu         free  1.0765425  0.000000 -10.00000 10.000000 ## logsigma_x free  0.1931173 -2.302585 -11.51293  1.609438 ## logsigma_y free -2.3166274 -2.302585 -11.51293  1.609438"},{"path":"/articles/construct_nll.html","id":"optimize-manually-using-statsoptim","dir":"Articles","previous_headings":"","what":"Optimize manually using stats::optim","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"supply initial parameter values, objective function handler gradient handler, parameter bounds optim.","code":"opt = stats::optim(par=nll$par,                     fn=nll$fn,                     gr=nll$gr,                     method=\"L-BFGS-B\",                     lower=pars$lower,                     upper=pars$upper)"},{"path":"/articles/construct_nll.html","id":"compare-results-between-the-two-optimizers","dir":"Articles","previous_headings":"","what":"Compare results between the two optimizers","title":"construct_nll: How to extract function handlers, and choosing your own optimizer","text":"Lets compare results using stats::optim extracted function handler versus internal optimisation uses stats::nlminb stored fit:","code":"# Estimated parameters data.frame(external=opt$par, internal=fit$par.fixed) ##              external   internal ## logtheta    2.7577960  2.7577902 ## mu          1.0765431  1.0765425 ## logsigma_x  0.1931184  0.1931173 ## logsigma_y -2.3166255 -2.3166274 # Neg. Log-Likelihood data.frame(external=opt$value, internal=fit$nll) ##    external  internal ## 1 -38.66878 -38.66878 # Gradient components data.frame(external=t(nll$gr(opt$par)), internal=t(nll$gr(fit$par.fixed))) ##       external      internal ## 1 9.631765e-05  5.788554e-08 ## 2 2.095449e-05 -1.778654e-07 ## 3 6.934801e-05  3.715852e-08 ## 4 1.466123e-04  4.008002e-08"},{"path":"/articles/estimate.html","id":"construct-model-object","dir":"Articles","previous_headings":"","what":"Construct model object","title":"estimate: Estimating model parameters and states","text":"now construct sdeTMB model object per usual","code":"# Create model object obj = sdeTMB$new()  # Set name of model (and the created .cpp file) obj$set_modelname(\"ornstein_uhlenbeck\")  # Add system equations obj$add_systems(   dx ~ theta * (mu-x) * dt + sigma_x*dw )  # Add observation equations obj$add_observations(   y ~ x )  # Set observation equation variances obj$add_observation_variances(   y ~ sigma_y^2 )  # Specify algebraic relations obj$add_algebraics(   theta ~ exp(logtheta),   sigma_x ~ exp(logsigma_x),   sigma_y ~ exp(logsigma_y) )  # Specify parameter initial values and lower/upper bounds in estimation obj$add_parameters(   logtheta   = log(c(initial = 5,    lower = 0,    upper = 20)),   mu         = c(    initial = 0,    lower = -10,  upper = 10),   logsigma_x = log(c(initial = 1e-1, lower = 1e-5, upper = 5)),   logsigma_y = log(c(initial = 1e-1, lower = 1e-5, upper = 5)) )  # Set initial state mean and covariance obj$set_initial_state(list(x[1], 1e-1*diag(1)))"},{"path":"/articles/estimate.html","id":"using-estimate---default-settings","dir":"Articles","previous_headings":"","what":"Using estimate - default settings","title":"estimate: Estimating model parameters and states","text":"can run estimate directly default settings using default settings Let’s walk various arguments effect:","code":"obj$estimate(.data) obj$estimate(.data,              method=\"ekf\",              ode.solver=\"euler\",              ode.timestep=min(diff(.data$t)),              loss = \"quadratic\",              loss_c = 3,              use.hessian = FALSE,              compile=FALSE,              control=list(trace=1) )"},{"path":"/articles/estimate.html","id":"argument-method","dir":"Articles","previous_headings":"","what":"Argument: method","title":"estimate: Estimating model parameters and states","text":"method argument determines underlying estimation techniques used. current implementation supports following method='ekf': Extended Kalman Filter. method='ukf': Unscented Kalman Filter. method='tmb': Laplace Approximation former two quite similar based Kalman Filter theory. assumptions normality state transition observation equation fundamental, although implemented filters standard non-linear filters, sense try overcome assumptions small non-linearities. Unscented Kalman Filter generally considered perform better cases. latter tmb method aptly named TMB package employs Laplace Approximation method integration random effects. formulation consider states random effects, parameters fixed. underlying assumption one normality, implementation allows flexibility choosing arbitrary distributions (yet implemented.) methods can used estimate parameter states. case tmb states smoothed (conditioned past future observations).","code":""},{"path":"/articles/estimate.html","id":"argument-ode-solver","dir":"Articles","previous_headings":"","what":"Argument: ode.solver","title":"estimate: Estimating model parameters and states","text":"argument used Kalman Filter methods .e. ekf ukf. argument determines algorithm used integrate forward moment (mean variance) differential equations. current implementation supports ode.solver='euler': forward Euler scheme ode.solver='rk4': 4th order Runge-Kutta scheme","code":""},{"path":"/articles/estimate.html","id":"argument-ode-timestep","dir":"Articles","previous_headings":"","what":"Argument: ode.timestep","title":"estimate: Estimating model parameters and states","text":"argument determines time-step used ODE solvers","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"/articles/observation_equations.html","id":"adding-observation-equations","dir":"Articles","previous_headings":"","what":"Adding observation equations","title":"observations: Using functions on the left-hand side","text":"Let’s assume observations \\(y_{t}\\) log-normally distributed conditioned \\(x_{t}\\) .e. \\[ \\log y_{t_{}} \\sim \\mathcal{N}(x_{t_{}},\\sigma_{y}^{2}) \\] sufficient user provide data column y provided data.frame e.g. estimate predict adding following observation equation Note kind observation equations, left-hand side function one () observed variables must explicitly named using obsnames argument.","code":"obj$add_observations(   log(y) ~ x, obsnames = \"log_y\" )"},{"path":"/articles/observation_equations.html","id":"adding-observation-variances","dir":"Articles","previous_headings":"","what":"Adding observation variances","title":"observations: Using functions on the left-hand side","text":"names given obsnames important needed specify observation variance. example code work, observation named log_y correct way add observation variance :","code":"obj$add_observation_variances(   y ~ sigma_y^2 ) ## Error in check_observation_variance_eqs(form, self, private): Please add an observation equation for y before specifying its variance obj$add_observation_variances(   log_y ~ sigma_y^2 )"},{"path":"/articles/observation_equations.html","id":"multiple-observation-equations","dir":"Articles","previous_headings":"","what":"Multiple observation equations","title":"observations: Using functions on the left-hand side","text":"must supply multiple obsnames supplying multiple observatin equations, although name used left-hand side just single variable .e.","code":"obj$add_observations(   log(y) ~ x,   y ~ x,   y^2+z^3 ~ x,   obsnames = c(\"log_y\", NA, \"y2_plus_z3\") )"},{"path":"/articles/predict.html","id":"simulate-from-the-ornstein-uhlenbeck-process","dir":"Articles","previous_headings":"","what":"Simulate from the Ornstein-Uhlenbeck process","title":"predict: Forecasting the model states and observations.","text":"use Ornstein-Uhlenbeck process . \\[ \\mathrm{d}X_{t} = \\theta (\\mu - X_{t}) \\, \\mathrm{d}t \\, + \\sigma_{X} \\, \\mathrm{d}B_{t} \\] \\[ Y_{t_{k}} = X_{t_{k}} + e_{t_{k}}, \\qquad e_{t_{k}} \\sim \\mathcal{N}\\left(0,\\sigma_{Y}^{2}\\right)   \\] first create data simulating process","code":"# Simulate data using Euler Maruyama set.seed(10) theta=10; mu=1; sigma_x=1; sigma_y=1e-1 #  dt.sim = 1e-3 t.sim = seq(0,1,by=dt.sim) dw = rnorm(length(t.sim)-1,sd=sqrt(dt.sim)) x = 3 for(i in 1:(length(t.sim)-1)) {   x[i+1] = x[i] + theta*(mu-x[i])*dt.sim + sigma_x*dw[i] }  # Extract observations and add noise dt.obs = 1e-2 t.obs = seq(0,1,by=dt.obs) y = x[t.sim %in% t.obs] + sigma_y * rnorm(length(t.obs))  # Create data .data = data.frame(   t = t.obs,   y = y )"},{"path":"/articles/predict.html","id":"construct-model-object","dir":"Articles","previous_headings":"","what":"Construct model object","title":"predict: Forecasting the model states and observations.","text":"now construct sdeTMB model object","code":"# Create model object obj = sdeTMB$new()  # Set name of model (and the created .cpp file) obj$set_modelname(\"ornstein_uhlenbeck\")  # Add system equations obj$add_systems(   dx ~ theta * (mu-x) * dt + sigma_x*dw )  # Add observation equations obj$add_observations(   y ~ x )  # Set observation equation variances obj$add_observation_variances(   y ~ sigma_y^2 )  # Specify algebraic relations obj$add_algebraics(   theta ~ exp(logtheta),   sigma_x ~ exp(logsigma_x),   sigma_y ~ exp(logsigma_y) )  # Specify parameter initial values and lower/upper bounds in estimation obj$add_parameters(   logtheta   = log(c(initial = 5,    lower = 0,    upper = 20)),   mu         = c(    initial = 0,    lower = -10,  upper = 10),   logsigma_x = log(c(initial = 1e-1, lower = 1e-5, upper = 5)),   logsigma_y = log(c(initial = 1e-1, lower = 1e-5, upper = 5)) )  # Set initial state mean and covariance obj$set_initial_state(list(x[1], 1e-1*diag(1)))"},{"path":"/articles/predict.html","id":"predict","dir":"Articles","previous_headings":"","what":"Predict","title":"predict: Forecasting the model states and observations.","text":"can use predict function without called estimate first, case initial value parameters provided add_parameters used. output predict data.frame indices time-points, state values associated standard deviations, observations provided data, predicted observation values based predicted state values. indices j table refer expectation variance state vector \\[ \\mathrm{E}(x_{t_{}} | x_{t_{j}}, y_{t_{j}}) \\\\ \\mathrm{V}(x_{t_{}} | x_{t_{j}}, y_{t_{j}}) \\] moments given indices \\(\\) (time \\(t_{}\\)) conditioned information available indices \\(j\\) (time \\(t_{j}\\)). sense state/covariance predictions \\(=j\\) posterior estimates, others prior estimates. default standard deviations states returned. entire covariance matrix elements can returned via","code":"pred = obj$predict(.data) head(pred) ## $states ##     i.  j.  t.i  t.j k.ahead         x        var.x ## 1    0   0 0.00 0.00       0 3.0000000 0.1000000000 ## 2    0   1 0.00 0.01       1 2.8536883 0.0905789125 ## 3    1   1 0.01 0.01       0 2.7041164 0.0090057558 ## 4    1   2 0.01 0.02       1 2.5722351 0.0082439081 ## 5    2   2 0.02 0.02       0 2.6004105 0.0045187183 ## 6    2   3 0.02 0.03       1 2.4735870 0.0041838682 ## 7    3   3 0.03 0.03       0 2.4126775 0.0029497371 ## 8    3   4 0.03 0.04       1 2.2950098 0.0027641952 ## 9    4   4 0.04 0.04       0 2.2023814 0.0021655852 ## 10   4   5 0.04 0.05       1 2.0949700 0.0020546652 ## 11   5   5 0.05 0.05       0 2.0464391 0.0017044565 ## 12   5   6 0.05 0.06       1 1.9466331 0.0016374186 ## 13   6   6 0.06 0.06       0 1.9220889 0.0014070291 ## 14   6   7 0.06 0.07       1 1.8283475 0.0013682952 ## 15   7   7 0.07 0.07       0 1.8281541 0.0012036063 ## 16   7   8 0.07 0.08       1 1.7389940 0.0011842306 ## 17   8   8 0.08 0.08       0 1.7041538 0.0010588396 ## 18   8   9 0.08 0.09       1 1.6210412 0.0010532403 ## 19   9   9 0.09 0.09       0 1.6291405 0.0009528792 ## 20   9  10 0.09 0.10       1 1.5496864 0.0009573633 ## 21  10  10 0.10 0.10       0 1.5494076 0.0008737169 ## 22  10  11 0.10 0.11       1 1.4738421 0.0008857343 ## 23  11  11 0.11 0.11       0 1.4837636 0.0008136652 ## 24  11  12 0.11 0.12       1 1.4113996 0.0008313973 ## 25  12  12 0.12 0.12       0 1.4374217 0.0007675808 ## 26  12  13 0.12 0.13       1 1.3673178 0.0007896984 ## 27  13  13 0.13 0.13       0 1.3695955 0.0007319003 ## 28  13  14 0.13 0.14       1 1.3027995 0.0007574134 ## 29  14  14 0.14 0.14       0 1.3061822 0.0007040850 ## 30  14  15 0.14 0.15       1 1.2424790 0.0007322450 ## 31  15  15 0.15 0.15       0 1.2446653 0.0006822851 ## 32  15  16 0.15 0.16       1 1.1839623 0.0007125196 ## 33  16  16 0.16 0.16       0 1.1922016 0.0006651279 ## 34  16  17 0.16 0.17       1 1.1340572 0.0006969952 ## 35  17  17 0.17 0.17       0 1.1294292 0.0006515804 ## 36  17  18 0.17 0.18       1 1.0743463 0.0006847368 ## 37  18  18 0.18 0.18       0 1.0706612 0.0006408551 ## 38  18  19 0.18 0.19       1 1.0184444 0.0006750323 ## 39  19  19 0.19 0.19       0 1.0278052 0.0006323468 ## 40  19  20 0.19 0.20       1 0.9776785 0.0006673336 ## 41  20  20 0.20 0.20       0 0.9704597 0.0006255861 ## 42  20  21 0.20 0.21       1 0.9231298 0.0006612163 ## 43  21  21 0.21 0.21       0 0.9315183 0.0006202072 ## 44  21  22 0.21 0.22       1 0.8860876 0.0006563492 ## 45  22  22 0.22 0.22       0 0.8901063 0.0006159232 ## 46  22  23 0.22 0.23       1 0.8466953 0.0006524729 ## 47  23  23 0.23 0.23       0 0.8567910 0.0006125084 ## 48  23  24 0.23 0.24       1 0.8150048 0.0006493830 ## 49  24  24 0.24 0.24       0 0.8140256 0.0006097847 ## 50  24  25 0.24 0.25       1 0.7743251 0.0006469185 ## 51  25  25 0.25 0.25       0 0.7835132 0.0006076110 ## 52  25  26 0.25 0.26       1 0.7453008 0.0006449518 ## 53  26  26 0.26 0.26       0 0.7479445 0.0006058757 ## 54  26  27 0.26 0.27       1 0.7114668 0.0006433815 ## 55  27  27 0.27 0.27       0 0.7249522 0.0006044898 ## 56  27  28 0.27 0.28       1 0.6895959 0.0006421275 ## 57  28  28 0.28 0.28       0 0.7017095 0.0006033827 ## 58  28  29 0.28 0.29       1 0.6674867 0.0006411258 ## 59  29  29 0.29 0.29       0 0.6784737 0.0006024981 ## 60  29  30 0.29 0.30       1 0.6453841 0.0006403253 ## 61  30  30 0.30 0.30       0 0.6826068 0.0006017911 ## 62  30  31 0.30 0.31       1 0.6493156 0.0006396857 ## 63  31  31 0.31 0.31       0 0.6796551 0.0006012261 ## 64  31  32 0.31 0.32       1 0.6465080 0.0006391744 ## 65  32  32 0.32 0.32       0 0.6964303 0.0006007745 ## 66  32  33 0.32 0.33       1 0.6624650 0.0006387658 ## 67  33  33 0.33 0.33       0 0.6996848 0.0006004134 ## 68  33  34 0.33 0.34       1 0.6655608 0.0006384391 ## 69  34  34 0.34 0.34       0 0.6951424 0.0006001248 ## 70  34  35 0.34 0.35       1 0.6612399 0.0006381779 ## 71  35  35 0.35 0.35       0 0.6982807 0.0005998940 ## 72  35  36 0.35 0.36       1 0.6642252 0.0006379691 ## 73  36  36 0.36 0.36       0 0.7189928 0.0005997095 ## 74  36  37 0.36 0.37       1 0.6839271 0.0006378021 ## 75  37  37 0.37 0.37       0 0.7403732 0.0005995619 ## 76  37  38 0.37 0.38       1 0.7042648 0.0006376686 ## 77  38  38 0.38 0.38       0 0.7515000 0.0005994440 ## 78  38  39 0.38 0.39       1 0.7148489 0.0006375619 ## 79  39  39 0.39 0.39       0 0.7559364 0.0005993496 ## 80  39  40 0.39 0.40       1 0.7190689 0.0006374765 ## 81  40  40 0.40 0.40       0 0.7666375 0.0005992742 ## 82  40  41 0.40 0.41       1 0.7292482 0.0006374083 ## 83  41  41 0.41 0.41       0 0.7667833 0.0005992139 ## 84  41  42 0.41 0.42       1 0.7293868 0.0006373537 ## 85  42  42 0.42 0.42       0 0.7561428 0.0005991656 ## 86  42  43 0.42 0.43       1 0.7192653 0.0006373100 ## 87  43  43 0.43 0.43       0 0.7493877 0.0005991271 ## 88  43  44 0.43 0.44       1 0.7128396 0.0006372751 ## 89  44  44 0.44 0.44       0 0.7534882 0.0005990962 ## 90  44  45 0.44 0.45       1 0.7167401 0.0006372472 ## 91  45  45 0.45 0.45       0 0.7514280 0.0005990716 ## 92  45  46 0.45 0.46       1 0.7147804 0.0006372249 ## 93  46  46 0.46 0.46       0 0.7372187 0.0005990518 ## 94  46  47 0.46 0.47       1 0.7012642 0.0006372071 ## 95  47  47 0.47 0.47       0 0.7323972 0.0005990361 ## 96  47  48 0.47 0.48       1 0.6966778 0.0006371928 ## 97  48  48 0.48 0.48       0 0.7285917 0.0005990235 ## 98  48  49 0.48 0.49       1 0.6930578 0.0006371814 ## 99  49  49 0.49 0.49       0 0.7115398 0.0005990134 ## 100 49  50 0.49 0.50       1 0.6768376 0.0006371723 ## 101 50  50 0.50 0.50       0 0.7017129 0.0005990053 ## 102 50  51 0.50 0.51       1 0.6674899 0.0006371650 ## 103 51  51 0.51 0.51       0 0.6985287 0.0005989989 ## 104 51  52 0.51 0.52       1 0.6644611 0.0006371591 ## 105 52  52 0.52 0.52       0 0.6888187 0.0005989937 ## 106 52  53 0.52 0.53       1 0.6552246 0.0006371545 ## 107 53  53 0.53 0.53       0 0.6817039 0.0005989896 ## 108 53  54 0.53 0.54       1 0.6484569 0.0006371507 ## 109 54  54 0.54 0.54       0 0.6675931 0.0005989863 ## 110 54  55 0.54 0.55       1 0.6350342 0.0006371477 ## 111 55  55 0.55 0.55       0 0.6484261 0.0005989836 ## 112 55  56 0.55 0.56       1 0.6168020 0.0006371454 ## 113 56  56 0.56 0.56       0 0.6258193 0.0005989815 ## 114 56  57 0.56 0.57       1 0.5952978 0.0006371434 ## 115 57  57 0.57 0.57       0 0.6230721 0.0005989798 ## 116 57  58 0.57 0.58       1 0.5926845 0.0006371419 ## 117 58  58 0.58 0.58       0 0.6346486 0.0005989785 ## 118 58  59 0.58 0.59       1 0.6036964 0.0006371407 ## 119 59  59 0.59 0.59       0 0.6185911 0.0005989774 ## 120 59  60 0.59 0.60       1 0.5884220 0.0006371397 ## 121 60  60 0.60 0.60       0 0.6184279 0.0005989765 ## 122 60  61 0.60 0.61       1 0.5882668 0.0006371389 ## 123 61  61 0.61 0.61       0 0.6261620 0.0005989759 ## 124 61  62 0.61 0.62       1 0.5956237 0.0006371383 ## 125 62  62 0.62 0.62       0 0.6192352 0.0005989753 ## 126 62  63 0.62 0.63       1 0.5890347 0.0006371378 ## 127 63  63 0.63 0.63       0 0.6107497 0.0005989749 ## 128 63  64 0.63 0.64       1 0.5809631 0.0006371374 ## 129 64  64 0.64 0.64       0 0.6002009 0.0005989745 ## 130 64  65 0.64 0.65       1 0.5709288 0.0006371371 ## 131 65  65 0.65 0.65       0 0.5907953 0.0005989742 ## 132 65  66 0.65 0.66       1 0.5619819 0.0006371368 ## 133 66  66 0.66 0.66       0 0.5981402 0.0005989740 ## 134 66  67 0.66 0.67       1 0.5689685 0.0006371366 ## 135 67  67 0.67 0.67       0 0.6026078 0.0005989738 ## 136 67  68 0.67 0.68       1 0.5732183 0.0006371365 ## 137 68  68 0.68 0.68       0 0.6142482 0.0005989737 ## 138 68  69 0.68 0.69       1 0.5842910 0.0006371363 ## 139 69  69 0.69 0.69       0 0.6101996 0.0005989736 ## 140 69  70 0.69 0.70       1 0.5804398 0.0006371362 ## 141 70  70 0.70 0.70       0 0.5998545 0.0005989735 ## 142 70  71 0.70 0.71       1 0.5705993 0.0006371362 ## 143 71  71 0.71 0.71       0 0.5962865 0.0005989734 ## 144 71  72 0.71 0.72       1 0.5672053 0.0006371361 ## 145 72  72 0.72 0.72       0 0.5742607 0.0005989733 ## 146 72  73 0.72 0.73       1 0.5462537 0.0006371360 ## 147 73  73 0.73 0.73       0 0.5520129 0.0005989733 ## 148 73  74 0.73 0.74       1 0.5250909 0.0006371360 ## 149 74  74 0.74 0.74       0 0.5222961 0.0005989733 ## 150 74  75 0.74 0.75       1 0.4968234 0.0006371360 ## 151 75  75 0.75 0.75       0 0.5135329 0.0005989732 ## 152 75  76 0.75 0.76       1 0.4884876 0.0006371359 ## 153 76  76 0.76 0.76       0 0.4918789 0.0005989732 ## 154 76  77 0.76 0.77       1 0.4678897 0.0006371359 ## 155 77  77 0.77 0.77       0 0.4970710 0.0005989732 ## 156 77  78 0.77 0.78       1 0.4728286 0.0006371359 ## 157 78  78 0.78 0.78       0 0.5001839 0.0005989732 ## 158 78  79 0.78 0.79       1 0.4757897 0.0006371359 ## 159 79  79 0.79 0.79       0 0.4952266 0.0005989732 ## 160 79  80 0.79 0.80       1 0.4710741 0.0006371359 ## 161 80  80 0.80 0.80       0 0.4898556 0.0005989731 ## 162 80  81 0.80 0.81       1 0.4659650 0.0006371359 ## 163 81  81 0.81 0.81       0 0.4883110 0.0005989731 ## 164 81  82 0.81 0.82       1 0.4644958 0.0006371359 ## 165 82  82 0.82 0.82       0 0.4998259 0.0005989731 ## 166 82  83 0.82 0.83       1 0.4754491 0.0006371358 ## 167 83  83 0.83 0.83       0 0.5009212 0.0005989731 ## 168 83  84 0.83 0.84       1 0.4764909 0.0006371358 ## 169 84  84 0.84 0.84       0 0.4840698 0.0005989731 ## 170 84  85 0.84 0.85       1 0.4604615 0.0006371358 ## 171 85  85 0.85 0.85       0 0.4836321 0.0005989731 ## 172 85  86 0.85 0.86       1 0.4600451 0.0006371358 ## 173 86  86 0.86 0.86       0 0.4708446 0.0005989731 ## 174 86  87 0.86 0.87       1 0.4478812 0.0006371358 ## 175 87  87 0.87 0.87       0 0.4690601 0.0005989731 ## 176 87  88 0.87 0.88       1 0.4461838 0.0006371358 ## 177 88  88 0.88 0.88       0 0.4655931 0.0005989731 ## 178 88  89 0.88 0.89       1 0.4428859 0.0006371358 ## 179 89  89 0.89 0.89       0 0.4795782 0.0005989731 ## 180 89  90 0.89 0.90       1 0.4561889 0.0006371358 ## 181 90  90 0.90 0.90       0 0.4962998 0.0005989731 ## 182 90  91 0.90 0.91       1 0.4720950 0.0006371358 ## 183 91  91 0.91 0.91       0 0.5143556 0.0005989731 ## 184 91  92 0.91 0.92       1 0.4892701 0.0006371358 ## 185 92  92 0.92 0.92       0 0.5279663 0.0005989731 ## 186 92  93 0.92 0.93       1 0.5022171 0.0006371358 ## 187 93  93 0.93 0.93       0 0.5562919 0.0005989731 ## 188 93  94 0.93 0.94       1 0.5291612 0.0006371358 ## 189 94  94 0.94 0.94       0 0.5800575 0.0005989731 ## 190 94  95 0.94 0.95       1 0.5517677 0.0006371358 ## 191 95  95 0.95 0.95       0 0.5961139 0.0005989731 ## 192 95  96 0.95 0.96       1 0.5670411 0.0006371358 ## 193 96  96 0.96 0.96       0 0.6175555 0.0005989731 ## 194 96  97 0.96 0.97       1 0.5874370 0.0006371358 ## 195 97  97 0.97 0.97       0 0.6473161 0.0005989731 ## 196 97  98 0.97 0.98       1 0.6157461 0.0006371358 ## 197 98  98 0.98 0.98       0 0.6654603 0.0005989731 ## 198 98  99 0.98 0.99       1 0.6330054 0.0006371358 ## 199 99  99 0.99 0.99       0 0.6715236 0.0005989731 ## 200 99 100 0.99 1.00       1 0.6387730 0.0006371358 ##  ## $observations ##       i.  j.  t.i  t.j k.ahead y.predict    y.data ## 1      0   0 0.00 0.00       0 3.0000000 3.1050014 ## 2      0   1 0.00 0.01       1 2.8536883 2.6876035 ## 2.1    1   1 0.01 0.01       0 2.7041164 2.6876035 ## 3      1   2 0.01 0.02       1 2.5722351 2.6345878 ## 3.1    2   2 0.02 0.02       0 2.6004105 2.6345878 ## 4      2   3 0.02 0.03       1 2.4735870 2.2670956 ## 4.1    3   3 0.03 0.03       0 2.4126775 2.2670956 ## 5      3   4 0.03 0.04       1 2.2950098 1.8672805 ## 5.1    4   4 0.04 0.04       0 2.2023814 1.8672805 ## 6      4   5 0.04 0.05       1 2.0949700 1.8102407 ## 6.1    5   5 0.05 0.05       0 2.0464391 1.8102407 ## 7      5   6 0.05 0.06       1 1.9466331 1.7721929 ## 7.1    6   6 0.06 0.06       0 1.9220889 1.7721929 ## 8      6   7 0.06 0.07       1 1.8283475 1.8267411 ## 8.1    7   7 0.07 0.07       0 1.8281541 1.8267411 ## 9      7   8 0.07 0.08       1 1.7389940 1.4099524 ## 9.1    8   8 0.08 0.08       0 1.7041538 1.4099524 ## 10     8   9 0.08 0.09       1 1.6210412 1.7060396 ## 10.1   9   9 0.09 0.09       0 1.6291405 1.7060396 ## 11     9  10 0.09 0.10       1 1.5496864 1.5464949 ## 11.1  10  10 0.10 0.10       0 1.5494076 1.5464949 ## 12    10  11 0.10 0.11       1 1.4738421 1.5957778 ## 12.1  11  11 0.11 0.11       0 1.4837636 1.5957778 ## 13    11  12 0.11 0.12       1 1.4113996 1.7504143 ## 13.1  12  12 0.12 0.12       0 1.4374217 1.7504143 ## 14    12  13 0.12 0.13       1 1.3673178 1.3984381 ## 14.1  13  13 0.13 0.13       0 1.3695955 1.3984381 ## 15    13  14 0.13 0.14       1 1.3027995 1.3508432 ## 15.1  14  14 0.14 0.14       0 1.3061822 1.3508432 ## 16    14  15 0.14 0.15       1 1.2424790 1.2745233 ## 16.1  15  15 0.15 0.15       0 1.2446653 1.2745233 ## 17    15  16 0.15 0.16       1 1.1839623 1.3078374 ## 17.1  16  16 0.16 0.16       0 1.1922016 1.3078374 ## 18    16  17 0.16 0.17       1 1.1340572 1.0630302 ## 18.1  17  17 0.17 0.17       0 1.1294292 1.0630302 ## 19    17  18 0.17 0.18       1 1.0743463 1.0168427 ## 19.1  18  18 0.18 0.18       0 1.0706612 1.0168427 ## 20    18  19 0.18 0.19       1 1.0184444 1.1664768 ## 20.1  19  19 0.19 0.19       0 1.0278052 1.1664768 ## 21    19  20 0.19 0.20       1 0.9776785 0.8622847 ## 21.1  20  20 0.20 0.20       0 0.9704597 0.8622847 ## 22    20  21 0.20 0.21       1 0.9231298 1.0583837 ## 22.1  21  21 0.21 0.21       0 0.9315183 1.0583837 ## 23    21  22 0.21 0.22       1 0.8860876 0.9513334 ## 23.1  22  22 0.22 0.22       0 0.8901063 0.9513334 ## 24    22  23 0.22 0.23       1 0.8466953 1.0115208 ## 24.1  23  23 0.23 0.23       0 0.8567910 1.0115208 ## 25    23  24 0.23 0.24       1 0.8150048 0.7989467 ## 25.1  24  24 0.24 0.24       0 0.8140256 0.7989467 ## 26    24  25 0.24 0.25       1 0.7743251 0.9255422 ## 26.1  25  25 0.25 0.25       0 0.7835132 0.9255422 ## 27    25  26 0.25 0.26       1 0.7453008 0.7889344 ## 27.1  26  26 0.26 0.26       0 0.7479445 0.7889344 ## 28    26  27 0.26 0.27       1 0.7114668 0.9345539 ## 28.1  27  27 0.27 0.27       0 0.7249522 0.9345539 ## 29    27  28 0.27 0.28       1 0.6895959 0.8903579 ## 29.1  28  28 0.28 0.28       0 0.7017095 0.8903579 ## 30    28  29 0.28 0.29       1 0.6674867 0.8498436 ## 30.1  29  29 0.29 0.29       0 0.6784737 0.8498436 ## 31    29  30 0.29 0.30       1 0.6453841 1.2639148 ## 31.1  30  30 0.30 0.30       0 0.6826068 1.2639148 ## 32    30  31 0.30 0.31       1 0.6493156 1.1539427 ## 32.1  31  31 0.31 0.31       0 0.6796551 1.1539427 ## 33    31  32 0.31 0.32       1 0.6465080 1.4774740 ## 33.1  32  32 0.32 0.32       0 0.6964303 1.4774740 ## 34    32  33 0.32 0.33       1 0.6624650 1.2823684 ## 34.1  33  33 0.33 0.33       0 0.6996848 1.2823684 ## 35    33  34 0.33 0.34       1 0.6655608 1.1584845 ## 35.1  34  34 0.34 0.34       0 0.6951424 1.1584845 ## 36    34  35 0.34 0.35       1 0.6612399 1.2786969 ## 36.1  35  35 0.35 0.35       0 0.6982807 1.2786969 ## 37    35  36 0.35 0.36       1 0.6642252 1.5774615 ## 37.1  36  36 0.36 0.36       0 0.7189928 1.5774615 ## 38    36  37 0.36 0.37       1 0.6839271 1.6253826 ## 38.1  37  37 0.37 0.37       0 0.7403732 1.6253826 ## 39    37  38 0.37 0.38       1 0.7042648 1.4922488 ## 39.1  38  38 0.38 0.38       0 0.7515000 1.4922488 ## 40    38  39 0.38 0.39       1 0.7148489 1.4003827 ## 40.1  39  39 0.39 0.39       0 0.7559364 1.4003827 ## 41    39  40 0.39 0.40       1 0.7190689 1.5128390 ## 41.1  40  40 0.40 0.40       0 0.7666375 1.5128390 ## 42    40  41 0.40 0.41       1 0.7292482 1.3556542 ## 42.1  41  41 0.41 0.41       0 0.7667833 1.3556542 ## 43    41  42 0.41 0.42       1 0.7293868 1.1759413 ## 43.1  42  42 0.42 0.42       0 0.7561428 1.1759413 ## 44    42  43 0.42 0.43       1 0.7192653 1.2220367 ## 44.1  43  43 0.43 0.43       0 0.7493877 1.2220367 ## 45    43  44 0.43 0.44       1 0.7128396 1.3913373 ## 45.1  44  44 0.44 0.44       0 0.7534882 1.3913373 ## 46    44  45 0.44 0.45       1 0.7167401 1.2957664 ## 46.1  45  45 0.45 0.45       0 0.7514280 1.2957664 ## 47    45  46 0.45 0.46       1 0.7147804 1.0893450 ## 47.1  46  46 0.46 0.46       0 0.7372187 1.0893450 ## 48    46  47 0.46 0.47       1 0.7012642 1.2209833 ## 48.1  47  47 0.47 0.47       0 0.7323972 1.2209833 ## 49    47  48 0.47 0.48       1 0.6966778 1.2294432 ## 49.1  48  48 0.48 0.48       0 0.7285917 1.2294432 ## 50    48  49 0.48 0.49       1 0.6930578 1.0015985 ## 50.1  49  49 0.49 0.49       0 0.7115398 1.0015985 ## 51    49  50 0.49 0.50       1 0.6768376 1.0921132 ## 51.1  50  50 0.50 0.50       0 0.7017129 1.0921132 ## 52    50  51 0.50 0.51       1 0.6674899 1.1856681 ## 52.1  51  51 0.51 0.51       0 0.6985287 1.1856681 ## 53    51  52 0.51 0.52       1 0.6644611 1.0711030 ## 53.1  52  52 0.52 0.52       0 0.6888187 1.0711030 ## 54    52  53 0.52 0.53       1 0.6552246 1.0972914 ## 54.1  53  53 0.53 0.53       0 0.6817039 1.0972914 ## 55    53  54 0.53 0.54       1 0.6484569 0.9679338 ## 55.1  54  54 0.54 0.54       0 0.6675931 0.9679338 ## 56    54  55 0.54 0.55       1 0.6350342 0.8586111 ## 56.1  55  55 0.55 0.55       0 0.6484261 0.8586111 ## 57    55  56 0.55 0.56       1 0.6168020 0.7673472 ## 57.1  56  56 0.56 0.56       0 0.6258193 0.7673472 ## 58    56  57 0.56 0.57       1 0.5952978 1.0589918 ## 58.1  57  57 0.57 0.57       0 0.6230721 1.0589918 ## 59    57  58 0.57 0.58       1 0.5926845 1.2932782 ## 59.1  58  58 0.58 0.58       0 0.6346486 1.2932782 ## 60    58  59 0.58 0.59       1 0.6036964 0.8523648 ## 60.1  59  59 0.59 0.59       0 0.6185911 0.8523648 ## 61    59  60 0.59 0.60       1 0.5884220 1.0893742 ## 61.1  60  60 0.60 0.60       0 0.6184279 1.0893742 ## 62    60  61 0.60 0.61       1 0.5882668 1.2209327 ## 62.1  61  61 0.61 0.61       0 0.6261620 1.2209327 ## 63    61  62 0.61 0.62       1 0.5956237 0.9898213 ## 63.1  62  62 0.62 0.62       0 0.6192352 0.9898213 ## 64    62  63 0.62 0.63       1 0.5890347 0.9515711 ## 64.1  63  63 0.63 0.63       0 0.6107497 0.9515711 ## 65    63  64 0.63 0.64       1 0.5809631 0.9021424 ## 65.1  64  64 0.64 0.64       0 0.6002009 0.9021424 ## 66    64  65 0.64 0.65       1 0.5709288 0.9026052 ## 66.1  65  65 0.65 0.65       0 0.5907953 0.9026052 ## 67    65  66 0.65 0.66       1 0.5619819 1.1656516 ## 67.1  66  66 0.66 0.66       0 0.5981402 1.1656516 ## 68    66  67 0.66 0.67       1 0.5689685 1.1305835 ## 68.1  67  67 0.67 0.67       0 0.6026078 1.1305835 ## 69    67  68 0.67 0.68       1 0.5732183 1.2582223 ## 69.1  68  68 0.68 0.68       0 0.6142482 1.2582223 ## 70    68  69 0.68 0.69       1 0.5842910 1.0168412 ## 70.1  69  69 0.69 0.69       0 0.6101996 1.0168412 ## 71    69  70 0.69 0.70       1 0.5804398 0.9045731 ## 71.1  70  70 0.70 0.70       0 0.5998545 0.9045731 ## 72    70  71 0.70 0.71       1 0.5705993 0.9994536 ## 72.1  71  71 0.71 0.71       0 0.5962865 0.9994536 ## 73    71  72 0.71 0.72       1 0.5672053 0.6849976 ## 73.1  72  72 0.72 0.72       0 0.5742607 0.6849976 ## 74    72  73 0.72 0.73       1 0.5462537 0.6424049 ## 74.1  73  73 0.73 0.73       0 0.5520129 0.6424049 ## 75    73  74 0.73 0.74       1 0.5250909 0.4784305 ## 75.1  74  74 0.74 0.74       0 0.5222961 0.4784305 ## 76    74  75 0.74 0.75       1 0.4968234 0.7757928 ## 76.1  75  75 0.75 0.75       0 0.5135329 0.7757928 ## 77    75  76 0.75 0.76       1 0.4884876 0.5451065 ## 77.1  76  76 0.76 0.76       0 0.4918789 0.5451065 ## 78    76  77 0.76 0.77       1 0.4678897 0.9550785 ## 78.1  77  77 0.77 0.77       0 0.4970710 0.9550785 ## 79    77  78 0.77 0.78       1 0.4728286 0.9295327 ## 79.1  78  78 0.78 0.78       0 0.5001839 0.9295327 ## 80    78  79 0.78 0.79       1 0.4757897 0.8002935 ## 80.1  79  79 0.79 0.79       0 0.4952266 0.8002935 ## 81    79  80 0.79 0.80       1 0.4710741 0.7846353 ## 81.1  80  80 0.80 0.80       0 0.4898556 0.7846353 ## 82    80  81 0.80 0.81       1 0.4659650 0.8390361 ## 82.1  81  81 0.81 0.81       0 0.4883110 0.8390361 ## 83    81  82 0.81 0.82       1 0.4644958 1.0543397 ## 83.1  82  82 0.82 0.82       0 0.4998259 1.0543397 ## 84    82  83 0.82 0.83       1 0.4754491 0.9007118 ## 84.1  83  83 0.83 0.83       0 0.5009212 0.9007118 ## 85    83  84 0.83 0.84       1 0.4764909 0.6030225 ## 85.1  84  84 0.84 0.84       0 0.4840698 0.6030225 ## 86    84  85 0.84 0.85       1 0.4604615 0.8472999 ## 86.1  85  85 0.85 0.85       0 0.4836321 0.8472999 ## 87    85  86 0.85 0.86       1 0.4600451 0.6403460 ## 87.1  86  86 0.86 0.86       0 0.4708446 0.6403460 ## 88    86  87 0.86 0.87       1 0.4478812 0.8014683 ## 88.1  87  87 0.87 0.87       0 0.4690601 0.8014683 ## 89    87  88 0.87 0.88       1 0.4461838 0.7702269 ## 89.1  88  88 0.88 0.88       0 0.4655931 0.7702269 ## 90    88  89 0.88 0.89       1 0.4428859 1.0554731 ## 90.1  89  89 0.89 0.89       0 0.4795782 1.0554731 ## 91    89  90 0.89 0.90       1 0.4561889 1.1258505 ## 91.1  90  90 0.90 0.90       0 0.4962998 1.1258505 ## 92    90  91 0.90 0.91       1 0.4720950 1.1776452 ## 92.1  91  91 0.91 0.91       0 0.5143556 1.1776452 ## 93    91  92 0.91 0.92       1 0.4892701 1.1353116 ## 93.1  92  92 0.92 0.92       0 0.5279663 1.1353116 ## 94    92  93 0.92 0.93       1 0.5022171 1.4050089 ## 94.1  93  93 0.93 0.93       0 0.5562919 1.4050089 ## 95    93  94 0.93 0.94       1 0.5291612 1.3788863 ## 95.1  94  94 0.94 0.94       0 0.5800575 1.3788863 ## 96    94  95 0.94 0.95       1 0.5517677 1.2921382 ## 96.1  95  95 0.95 0.95       0 0.5961139 1.2921382 ## 97    95  96 0.95 0.96       1 0.5670411 1.4103918 ## 97.1  96  96 0.96 0.96       0 0.6175555 1.4103918 ## 98    96  97 0.96 0.97       1 0.5874370 1.5871333 ## 98.1  97  97 0.97 0.97       0 0.6473161 1.5871333 ## 99    97  98 0.97 0.98       1 0.6157461 1.4457355 ## 99.1  98  98 0.98 0.98       0 0.6654603 1.4457355 ## 100   98  99 0.98 0.99       1 0.6330054 1.2760765 ## 100.1 99  99 0.99 0.99       0 0.6715236 1.2760765 ## 101   99 100 0.99 1.00       1 0.6387730 1.2007236 obj$predict(.data, return.covariance = TRUE)"},{"path":"/articles/predict.html","id":"set-number-of-prediction-steps","dir":"Articles","previous_headings":"","what":"Set number of prediction steps","title":"predict: Forecasting the model states and observations.","text":"number time steps ahead predictions desired can changed k.ahead argument. default behaviour save prediction steps 1 k.ahead selected desired, return.k.ahead argument can used indicate kept output.","code":"pred1 = obj$predict(.data, k.ahead=2) pred2 = obj$predict(.data, k.ahead=10, return.k.ahead=c(2,5,8)) head(pred1$states) ##   i. j.  t.i  t.j k.ahead        x       var.x ## 1  0  0 0.00 0.00       0 3.000000 0.100000000 ## 2  0  1 0.00 0.01       1 2.853688 0.090578913 ## 3  0  2 0.00 0.02       2 2.714512 0.082054359 ## 4  1  1 0.01 0.01       0 2.704116 0.009005756 ## 5  1  2 0.01 0.02       1 2.572235 0.008243908 ## 6  1  3 0.01 0.03       2 2.446786 0.007554560 head(pred2$states) ##    i. j.  t.i  t.j k.ahead        x       var.x ## 3   0  2 0.00 0.02       2 2.714512 0.082054359 ## 6   0  5 0.00 0.05       5 2.336402 0.061046563 ## 9   0  8 0.00 0.08       8 2.010960 0.045483600 ## 14  1  3 0.01 0.03       2 2.446786 0.007554560 ## 17  1  6 0.01 0.06       5 2.105968 0.005855739 ## 20  1  9 0.01 0.09       8 1.812623 0.004597221"},{"path":"/articles/predict.html","id":"set-the-model-parameters-used","dir":"Articles","previous_headings":"","what":"Set the model parameters used","title":"predict: Forecasting the model states and observations.","text":"default predict use initial parameters supplied add_parameters, unless estimate function succesfully run, predict use parameter values found minimizer. can provide parameters using pars argument method .e.","code":"some.other.random.pars = rnorm(length(fit$par.fixed)) pred = obj$predict(.data, pars=some.other.random.pars)"},{"path":"/articles/predict.html","id":"set-the-initial-state-and-covariance","dir":"Articles","previous_headings":"","what":"Set the initial state and covariance","title":"predict: Forecasting the model states and observations.","text":"default behaviour predict use initial state covariance suppled calling set_initial_state method. can important change one wishes correctly predict first observations provided prediction data series. can supply x0 p0 arguments updated state covariance estimates","code":"new.initial.x0 = rnorm(1) new.initial.p0 = rnorm(1)*diag(1) pred = obj$predict(data=.data,                    initial.state = list(                      new.state.value,                      new.covariance.value                    ) )"},{"path":"/articles/predict.html","id":"the-solver-options","dir":"Articles","previous_headings":"","what":"The solver options","title":"predict: Forecasting the model states and observations.","text":"can choose solver options use via arguments ode.solver ode.timestep. ode.solver decides ode solver algorithm used solving mean variance ODEs SDE. ode.timestep determines time step-size using solving ODEs, default value minimum observed time difference provided data time vector (min(diff(.data$t))). time step-size can’t smaller . chosen time step-size \\(\\Delta_{step}\\) “almost” divide observation time differences data \\(\\Delta_{obs}\\) .e. \\[ \\frac{\\Delta_{obs}}{\\Delta_{step}} - \\bigg\\lfloor \\frac{\\Delta_{obs}}{\\Delta_{step}} \\bigg\\rfloor \\geq 0.02 \\] time step-size reduced divide evenly setting \\[ \\frac{\\Delta_{obs}}{\\Delta_{step}} = \\bigg\\lceil \\frac{\\Delta_{obs}}{\\Delta_{step}} \\bigg\\rceil \\] words: takes \\(3.561\\) time-steps get \\(t_{}\\) \\(t_{+1}\\) take \\(4\\) time-steps instead, calculate reduced time-step true. \\(3.01\\) time-steps retain original time-step, ignoring small temporal discrepancy. provide arguments via","code":"obj$predict(.data,             ode.timestep = min(diff(.data$t)) )"},{"path":"/articles/predict.html","id":"use-case","dir":"Articles","previous_headings":"","what":"Use-case","title":"predict: Forecasting the model states and observations.","text":"use model predictions observation compute model performance score e.g. RMSE (root-mean square error). first estimate model parameters, automatically used calling predict. predict 10-steps ahead, return values. Let’s plot 10-step predictions observations. notice 10-step predictions state uncertainty (95%) much larger filtered posterior state estimates fit .e. can calculate RMSE prediction score prediction step follows:","code":"fit = obj$estimate(.data) pred = obj$predict(.data, k.ahead=10) pred.states = pred$states pred.obs = pred$observations # ggplot2 theme library(ggplot2) mytheme =   theme_minimal() +    theme(     text             = element_text(\"Avenir Next Condensed\",size=15),     legend.text      = element_text(size=15),     axis.text        = element_text(size=15),     strip.text       = element_text(face=\"bold\",size=15),     legend.box       = \"vertical\",     legend.position  = \"top\",     plot.title       = element_text(hjust=0.5)   ) pred10 = pred.states[pred.states$k.ahead==10,] data = .data ggplot() +   geom_line(aes(x=pred10$t.j,y=pred10$x,color=\"10-Step Predictions\")) +     geom_ribbon(aes(x=pred10$t.j,ymin=pred10$x-2*sqrt(pred10$var.x),ymax=pred10$x+2*sqrt(pred10$var.x)),fill=\"grey\",alpha=0.5) +   geom_point(aes(x=data$t,data$y,color=\"Observations\")) +   labs(color=\"\",x=\"Time\",y=\"\") +   # coord_cartesian(xlim=c(0,0.1)) +   mytheme t         = fit$states$mean$posterior$t xpost     = fit$states$mean$posterior$x xpost_sd  = fit$states$sd$posterior$x  ggplot() +   geom_line(aes(x=t,y=xpost,color=\"0-Step Predictions (Posterior State Estimates)\"),lwd=1) +   geom_ribbon(aes(x=t,ymin=xpost-2*xpost_sd,ymax=xpost+2*xpost_sd),fill=\"grey\",alpha=0.5) +   geom_point(aes(x=data$t,data$y,color=\"Observations\")) +   labs(x = \"Time\", y = \"\", color=\"\") +   mytheme rmse = c() k.ahead = 1:10 for(i in k.ahead){   xy = data.frame(     x = pred.states[pred.states$k.ahead==i,\"x\"],     y = pred.obs[pred.obs$k.ahead==i,\"y.data\"]   )   rmse[i] = sqrt(mean((xy[[\"x\"]] - xy[[\"y\"]])^2)) }  ggplot() +   geom_line(aes(k.ahead, rmse), color=\"steelblue\") +    geom_point(aes(k.ahead, rmse), color=\"red\") +   labs(     title = \"Root-Mean Square Errors for Different Prediction Horizons\",     x = \"Prediction Steps\",     y = \"Root-Mean-Square Errors\"     ) +   mytheme"},{"path":"/articles/sdeTMB.html","id":"initialising","dir":"Articles","previous_headings":"","what":"Initialising","title":"Getting started","text":"initialise sdeTMB model object using can print object see kind model contains see model called sde_model (default), states, diffusions, observations, inputs parameters currently registered. name used name C++ file created locally, later recognize compiled model object.","code":"library(sdeTMB) obj = sdeTMB$new() print(obj) ## Stochastic State Space Model:                          ## Name         sdeTMB_model ## States                  0 ## Diffusions              0 ## Observations            0 ## Inputs                  0 ## Parameters              0"},{"path":"/articles/sdeTMB.html","id":"add-system-equations","dir":"Articles","previous_headings":"","what":"Add system equations","title":"Getting started","text":"can begin adding desired stochastic differential equation object. note drift term ends *dt diffusions specified dw dw# # can sequence numbers.","code":"obj$add_systems(dX ~ theta * (mu - X) * dt + sigma_x * dw)"},{"path":"/articles/sdeTMB.html","id":"add-observation-equations","dir":"Articles","previous_headings":"","what":"Add observation equations","title":"Getting started","text":"must also add observation equation. observations associated Y data also named Y.","code":"obj$add_observations(Y ~ X)"},{"path":"/articles/sdeTMB.html","id":"add-observation-variances","dir":"Articles","previous_headings":"","what":"Add observation variances","title":"Getting started","text":"every observation variable must also specify variance normally distributed residuals observation equation variable name left-hand side formula must match name previously defined via add_observations, variance associated observation equation. Let’s inspect model object now specified one state \\(X\\) observation \\(Y\\). diffusions count number \\(\\mathrm{d}\\omega_{}\\) terms. single equation can multiple diffusion terms .e. sigma_1 * dw1 + sigma_2*dw2). also note inputs parameter specified yet.","code":"obj$add_observation_variances(Y ~ sigma_y^2*U) print(obj) ## Stochastic State Space Model:                          ## Name         sdeTMB_model ## States                  1 ## Diffusions              1 ## Observations            1 ## Inputs                  0 ## Parameters              0 ##  ## System Equations: ##  ##   dX ~ theta * (mu - X) * dt + sigma_x * dw  ##  ## Observation Equations: ##  ##   Y:  Y ~ X + e   e ~ N(0, sigma_y^2 * U)"},{"path":"/articles/sdeTMB.html","id":"add-inputs","dir":"Articles","previous_headings":"","what":"Add inputs","title":"Getting started","text":"tell model variable names inputs via input values provided data, name, similar observations.","code":"obj$add_inputs(U)"},{"path":"/articles/sdeTMB.html","id":"add-parameters","dir":"Articles","previous_headings":"","what":"Add parameters","title":"Getting started","text":"must also specify (fixed effects) parameters, together initial value lower/upper bound, optimization. can fix parameter value (parameter becomes constant) supplying just single value. usually difficult identify noise parameters \\(\\left(\\sigma_{X},\\sigma_{Y}\\right)\\) practice, lets assume want fix \\(\\sigma_{Y}\\). done via Let’s inspect model object , see inputs parameters (non-fixed fixed) registered.","code":"obj$add_parameters(   theta   = c(initial = 5,    lower = 0,    upper = 20),   mu      = c(initial = 0,    lower = -10,  upper = 10),   sigma_x = c(initial = 1e-1, lower = 1e-5, upper = 5),   sigma_y = c(initial = 1e-1, lower = 1e-5, upper = 5) ) obj$add_parameters(   sigma_y  = 1e-1 ) print(obj) ## Stochastic State Space Model:                          ## Name         sdeTMB_model ## States                  1 ## Diffusions              1 ## Observations            1 ## Inputs                  1 ## Parameters              4 ##  ## System Equations: ##  ##   dX ~ theta * (mu - X) * dt + sigma_x * dw  ##  ## Observation Equations: ##  ##   Y:  Y ~ X + e   e ~ N(0, sigma_y^2 * U)  ##  ##  ## Parameters: ##   theta, mu, sigma_x, sigma_y ##  ## Fixed Parameters: ##   sigma_y"},{"path":"/articles/sdeTMB.html","id":"set-initial-state-and-covariance","dir":"Articles","previous_headings":"","what":"Set initial state and covariance","title":"Getting started","text":"last thing can perform estimation set initial value state(s) associated (co)variance. two inputs adequate since assume normally distributed state. choice value reflect ones belief initial state, often ballpark figure. Note use diag construct 1x1 matrix covariance, required method.","code":"obj$set_initial_state(list(mean=3, cov=1e-1*diag(1)))"},{"path":"/articles/sdeTMB.html","id":"fit-model-parameters-to-data","dir":"Articles","previous_headings":"","what":"Fit model parameters to data","title":"Getting started","text":"now ready perform state filtration parameter estimation. first construct fake data simulating paths Ornstein-Uhlenbeck process using Euler-Maruyama scheme. data must contain time column named t columns specified inputs observations. pass data estimate method. method build compile generated C++ function negative log-likelihood, check supplied data contains necessary variables, construct objective function (computational tree must build automatic differentiation) start optimization. output generated optimization objective (negativ log-likelihood) value parameter values current step. optimizer used package stats::nlminb. optimizer great robustness ability use objective function hessian unlike e.g. ‘stats::optim’","code":"# Choosing parameters set.seed(10) theta=10; mu=1; sigma_x=1; sigma_y=1e-1   # Creating simulation path dt.sim = 1e-3 t.sim = seq(0,1,by=dt.sim) dw = rnorm(length(t.sim)-1,sd=sqrt(dt.sim)) x = 3 for(i in 1:(length(t.sim)-1)) {   x[i+1] = x[i] + theta*(mu-x[i])*dt.sim + sigma_x*dw[i] }  # Extract observations from simulation and add noise dt.obs = 1e-2 t.obs = seq(0,1,by=dt.obs) y = x[t.sim %in% t.obs] + sigma_y * rnorm(length(t.obs))  # Create data.frame data = data.frame(   t = t.obs,   Y = y,   U = c(rep(c(1,2),times=round(length(y)/2)),1) ) fit = obj$estimate(data) ## Building model... ## Checking data... ## Constructing objective function and derivative tables... ## ...took: 0.01 seconds. ## Minimizing the negative log-likelihood... ##   0:     818.68776:  5.00000  0.00000 0.100000 ##   1:    -24.103906:  4.97527 0.144197  1.08924 ##   2:    -28.328685:  4.90919 0.634803  1.01897 ##   3:    -29.207179:  5.37297 0.821070  1.00446 ##   4:    -29.456330:  6.88456  1.17214 0.993856 ##   5:    -30.458098:  6.57835 0.975504  1.01495 ##   6:    -31.234909:  7.32661 0.961485  1.03777 ##   7:    -33.289229:  10.3202  1.00995  1.11343 ##   8:    -34.206473:  13.9863  1.11028  1.19968 ##   9:    -34.404517:  15.1360  1.04697  1.24056 ##  10:    -34.445598:  15.3060  1.07129  1.24149 ##  11:    -34.446681:  15.4313  1.07217  1.24460 ##  12:    -34.447225:  15.4899  1.07227  1.24584 ##  13:    -34.448679:  15.5925  1.07247  1.24735 ##  14:    -34.452034:  15.7461  1.07274  1.24803 ##  15:    -34.459028:  15.9476  1.07305  1.24525 ##  16:    -34.469519:  16.0951  1.07318  1.23518 ##  17:    -34.478453:  16.0313  1.07286  1.22001 ##  18:    -34.481612:  15.8386  1.07235  1.21104 ##  19:    -34.481942:  15.7524  1.07216  1.21018 ##  20:    -34.481951:  15.7436  1.07215  1.21053 ##  21:    -34.481951:  15.7437  1.07215  1.21057 ##  22:    -34.481951:  15.7438  1.07215  1.21057 ##   Optimization finished!: ##             Elapsed time: 0.005 seconds. ##             The objective value is: -3.448195e+01 ##             The maximum gradient component is: 1e-06 ##             The convergence message is: relative convergence (4) ##             Iterations: 22 ##             Evaluations: Fun: 24 Grad: 23 ##             See stats::nlminb for available tolerance/control arguments. ## Returning results... ## Finished!"},{"path":"/articles/sdeTMB.html","id":"important-note-for-model-changes","dir":"Articles","previous_headings":"","what":"Important Note for Model Changes","title":"Getting started","text":"change model later stage retain model name, need recompile C++ objective function. can like : receive error messages calling estimate regarding variables specified model, likely forgot recompile.","code":"obj$estimate(data, compile=TRUE)"},{"path":"/articles/sdeTMB.html","id":"parameter-estimates","dir":"Articles","previous_headings":"","what":"Parameter estimates","title":"Getting started","text":"Let’s inspect results estimation. can print fit object see standard coefficient matrix parameter estimates. can see parameter estimate associated standard error together t-test statistic P-value associated standard null-hypothesis \\[ H_{0}: p = 0 \\\\ H_{1}: p \\neq 0 \\] Note true parameter values set simulation step \\(\\theta = 10\\), \\(\\mu=1\\) \\(\\sigma_{X} = 1\\). parameter values, standard deviations covariance matrix can extracted via: estimated (fixed) parameters: standard deviations (fixed) parameters: covariance (fixed) parameters:","code":"print(fit) ## Coefficent Matrix  ##          Estimate Std. Error t value  Pr(>|t|)     ## theta   15.743756   3.806401  4.1361 7.366e-05 *** ## mu       1.072147   0.081688 13.1249 < 2.2e-16 *** ## sigma_x  1.210571   0.160547  7.5403 2.183e-11 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 fit$par.fixed ##     theta        mu   sigma_x  ## 15.743756  1.072147  1.210571 fit$sd.fixed ##      theta         mu    sigma_x  ## 3.80640122 0.08168822 0.16054743 fit$cov.fixed ##              theta          mu     sigma_x ## theta   14.4886902 0.085360603 0.210293731 ## mu       0.0853606 0.006672965 0.001238231 ## sigma_x  0.2102937 0.001238231 0.025775476"},{"path":"/articles/sdeTMB.html","id":"state-estimates","dir":"Articles","previous_headings":"","what":"State estimates","title":"Getting started","text":"can also plot prior posterior state estimates prior state estimate resulting estimate purely integrating mean covariance SDE system forward time, posterior state estimation obtained updating prior estimate information contained observation (using Bayes’ rule).","code":"library(ggplot2) library(patchwork) # ggplot2 theme mytheme =   theme_minimal() +    theme(     text             = element_text(\"Avenir Next Condensed\",size=15),     legend.text      = element_text(size=15),     axis.text        = element_text(size=15),     strip.text       = element_text(face=\"bold\",size=15),     panel.grid.major = element_blank(),     panel.grid.minor = element_blank(),     legend.box       = \"vertical\",     legend.position  = \"top\",     plot.title       = element_text(hjust=0.5)   ) t         = fit$states$mean$posterior$t xprior    = fit$states$mean$prior$X xpost     = fit$states$mean$posterior$X xpost_sd  = fit$states$sd$posterior$X  ggplot() +   geom_line(aes(x=t,y=xpost,color=\"State Estimates (Posterior)\"),lwd=1) +   geom_line(aes(x=t,y=xprior,color=\"State Estimates (Prior)\"),lwd=1) +   geom_ribbon(aes(x=t,ymin=xpost-2*xpost_sd,ymax=xpost+2*xpost_sd),fill=\"grey\",alpha=0.5) +   geom_point(aes(x=data$t,data$Y,color=\"Observations\")) +   guides(color=guide_legend(override.aes=list(shape=c(16,NA,NA),size=c(2,NA,NA),linetype=c(NA,1,1),lwd=c(NA,1,1)))) +   labs(x = \"Time\", y = \"\", color=\"\") +   mytheme"},{"path":"/articles/sdeTMB.html","id":"residual-analysis","dir":"Articles","previous_headings":"","what":"Residual analysis","title":"Getting started","text":"can display standard residual analysis observations calling plot fit object, invokes S3 plot.sdeTMB.fit method plot. includes quantile-quantile plot, histogram, auto-correlations cumulative periodogram. residuals (standard normalized) can extracted well, together standard deviation covariance matrix via fit$residuals","code":"plot(fit)"},{"path":"/articles/sdeTMB.html","id":"extra-adding-algebraic-equations","dir":"Articles","previous_headings":"","what":"Extra: Adding algebraic equations","title":"Getting started","text":"sake clarity can sometimes easier specify simple variables equations place (perhaps larger) expression. can redefine variable name providing algebraic relation. Let’s say wish consider positive values parameter \\(\\theta\\), appropriate estimate log-domain (since domain logarithm positive real axis). use \\(\\theta = \\exp\\left(\\log\\theta\\right)\\) introduce parameter logtheta replace theta. obviously just names, might well written exp(theta) directly specifying system equations, calling parameter logtheta reminds one really interested exponential parameter. specify algebraic relation like : parameter settings theta automatically transformed logtheta, must redefined:","code":"obj$add_algebraics(theta ~ exp(logtheta)) obj$add_parameters(logtheta = log(c(initial=5, lower=0, upper=20)))"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Phillip Vetter. Author, maintainer. Jan Møller. Contributor. Uffe Thygesen. Contributor. Peder Bacher. Contributor. Henrik Madsen. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Vetter P (2024). sdeTMB: Stochastic Differential Equations using Template Model Builder. R package version 0.5, https://github.com/phillipbvetter/sdeTMB.","code":"@Manual{,   title = {sdeTMB: Stochastic Differential Equations using Template Model Builder},   author = {Phillip Vetter},   year = {2024},   note = {R package version 0.5},   url = {https://github.com/phillipbvetter/sdeTMB}, }"},{"path":"/index.html","id":"stochastic-differential-equations-using-template-model-builder-sdetmb","dir":"","previous_headings":"","what":"Stochastic Differential Equations using Template Model Builder","title":"Stochastic Differential Equations using Template Model Builder","text":"sdeTMB R package parameter estimation, state filtration forecasting stochastic state space models, heavily inspired Continuous Time Stochastic Modelling. package user-friendly wrapper Template Model Builder frees user writing required C++ file containing (negative log) likelihood function . Instead, C++ script generated automatically based model specified user using provided R6 sdeTMB class object. package furthermore employs Rcpp package universe allow faster calculations model predictions stochastic simulation paths. package implements following methods (Continous-Discrete) Extended Kalman Filter, ekf (Continous-Discrete) Unscented Kalman Filter, ukf Laplace-style approach latent states considered random effects (see e.g. example), laplace main advantage Kalman Filter implementations large increase computation speed, access fixed effects hessian improved convergence optimization. cases TMB just provides automatic differentiation. district advantage laplace-style implementation use Laplace approximation likelihood calculations allows state space formulations density observation residuals non-Gaussian. package currently mostly tailored towards Kalman Filter, available methods predict simulate k-step-ahead predictions simulations. also S3 method implementation plot called sdeTMB.fit class object returned estimate method, plots basic residuals analysis using ggplot2 package.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Stochastic Differential Equations using Template Model Builder","text":"can install package copying command R. note sdeTMB depends following packages: 1. TMB 2. Rcpp 3. RcppEigen 4. RcppXPtrUtils 5. RcppZiggurat 6. R6 7. Deriv 8. stringr 9. stats user must therefore working C++ compiler. particular windows users install Rtools, Mac users install Command Line Tools get working C++ compilers. must make sure added PATH vislble R. information see TMB GitHub associated installation instructions Linux users need make sure GSL installed RcppZiggurat. can try following command, google .","code":"remotes::install_github(repo=\"phillipbvetter/sdeTMB\", dependencies=TRUE) sudo apt-get install libgsl-dev"},{"path":"/index.html","id":"how-to-get-started","dir":"","previous_headings":"","what":"How to get started","title":"Stochastic Differential Equations using Template Model Builder","text":"can visit package webpage browse vignettes example uses, particular see Getting Started.","code":""},{"path":"/index.html","id":"help","dir":"","previous_headings":"","what":"Help","title":"Stochastic Differential Equations using Template Model Builder","text":"can access documentation available methods individual methods can’t accessed directly .e. ?sdeTMB::estimate similar work. methods documentation also available homepage.","code":"?sdeTMB"},{"path":"/index.html","id":"example-usage","dir":"","previous_headings":"","what":"Example Usage","title":"Stochastic Differential Equations using Template Model Builder","text":"","code":"library(ggplot2) library(patchwork) library(dplyr) library(reshape2) library(sdeTMB)  ############################################################ # Data simulation ############################################################  # Simulate data using Euler Maruyama set.seed(10) pars = c(theta=10, mu=1, sigma_x=1, sigma_y=1e-2) #  dt.sim = 1e-3 t.sim = seq(0,1,by=dt.sim) dw = rnorm(length(t.sim)-1,sd=sqrt(dt.sim)) u.sim = cumsum(rnorm(length(t.sim))) x = 3 for(i in 1:(length(t.sim)-1)) {   x[i+1] = x[i] + pars[1]*(pars[2]-x[i]+u.sim[i])*dt.sim + pars[3]*dw[i] }  # Extract observations and add noise dt.obs = 1e-2 t.obs = seq(0,1,by=dt.obs) y = x[t.sim %in% t.obs] + pars[4] * rnorm(length(t.obs)) # forcing input u = u.sim[t.sim %in% t.obs]  # Create data .data = data.frame(   t = t.obs,   y = y,   u = u )  ############################################################ # Model creation and estimation ############################################################  # Create model object obj = sdeTMB$new()  # Set name of model (and the created .cpp file) obj$set_modelname(\"ornstein_uhlenbeck\")  # Add system equations obj$add_systems(   dx ~ theta * (mu-x+u) * dt + sigma_x*dw )  # Add observation equations obj$add_observations(   y ~ x )  # Set observation equation variances obj$add_observation_variances(   y ~ sigma_y^2 )  # Specify algebraic relations obj$add_algebraics(   theta   ~ exp(logtheta),   sigma_x ~ exp(logsigma_x),   sigma_y ~ exp(logsigma_y) )  # Add vector input obj$add_inputs(u)  # Specify parameter initial values and lower/upper bounds in estimation obj$add_parameters(   logtheta    = log(c(initial = 1, lower=1e-5, upper=50)),   mu          = c(initial=1.5, lower=0, upper=5),   logsigma_x  = log(c(initial= 1e-1, lower=1e-10, upper=10)),   logsigma_y  = log(c(initial=1e-1, lower=1e-10, upper=10)) )  # Set initial state mean and covariance obj$set_initial_state(list(x[1], 1e-1*diag(1)))  # Carry out estimation using extended kalman filter method with stats::nlminb as optimizer fit <- obj$estimate(data=.data,                      method=\"ekf\",                      use.hessian=TRUE, )  # Check parameter estimates against truth p0 = fit$par.fixed cbind(c(exp(p0[1]),p0[2],exp(p0[3]),exp(p0[4])), pars)  # Create plot of one-step predictions, simulated states and observations t.est = fit$states$mean$prior$t x.mean = fit$states$mean$prior$x x.sd = fit$states$sd$prior$x plot1 = ggplot() +   geom_ribbon(aes(x=t.est, ymin=x.mean-2*x.sd, ymax=x.mean+2*x.sd),fill=\"grey\", alpha=0.9) +   geom_line(aes(x=t.est, x.mean),col=\"steelblue\",lwd=1) +   geom_line(aes(x=t.sim,y=x)) +    geom_point(aes(x=t.obs,y=y),col=\"tomato\",size=2) +   labs(title=\"1-Step State Estimates vs Observations\", x=\"Time\", y=\"\") +   theme_minimal()  # Predict to obtain k-step-ahead predictions to see model forecasting ability pred.list = obj$predict(data=.data,                          k.ahead=10,                          method=\"ekf\", )  # Create plot all 10-step predictions against data pred = pred.list$states pred10step = pred %>% dplyr::filter(k.ahead==10) plot2 = ggplot() +   geom_ribbon(aes(x=pred10step$t.j,                    ymin=pred10step$x-2*sqrt(pred10step$var.x),                   ymax=pred10step$x+2*sqrt(pred10step$var.x)),fill=\"grey\", alpha=0.9) +   geom_line(aes(x=pred10step$t.j,pred10step$x),color=\"steelblue\",lwd=1) +   geom_point(aes(x=t.obs,y=y),color=\"tomato\",size=2) +   labs(title=\"10 Step Predictions vs Observations\", x=\"Time\", y=\"\") +   theme_minimal()  # Perform full prediction without data update pred.list = obj$predict(data=.data,                          k.ahead=1e6,                          method=\"ekf\", )  # Perform full simulation without data update sim.list = obj$simulate(data=.data,                          k.ahead=1e6,                          method=\"ekf\" )  # Collapse simulation data for easy use with ggplot  sim.df = sim.list$x[[1]] %>%   cbind(tj=sim.list$prediction_times[[1]],.) %>%   reshape2::melt(., id.var=\"t.j\")  # Plot all full simulations and the full prediction against observations # (full means no data-update at all) plot3 = ggplot() +   geom_line(data=sim.df, aes(x=t.j, y=value, group=variable),color=\"grey\") +   geom_line(aes(x=pred.list$states$t.j,y=pred.list$states$x),color=\"steelblue\") +   geom_point(aes(x=t.obs,y=y),color=\"tomato\",size=2) +   labs(title=\"No Update Prediction and Simulations vs Observations\", x=\"Time\", y=\"\") +   theme_minimal() + theme(legend.position = \"none\")  # Draw both plots patchwork::wrap_plots(plot1, plot2, plot3, ncol=1)  # Plot one-step-ahead residual analysis using the command below # plot(fit)"},{"path":"/reference/execute_ekf_prediction.html","id":null,"dir":"Reference","previous_headings":"","what":"export — execute_ekf_prediction","title":"export — execute_ekf_prediction","text":"export","code":""},{"path":"/reference/execute_ekf_prediction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"export — execute_ekf_prediction","text":"","code":"execute_ekf_prediction(   f__R,   g__R,   dfdx__R,   h__R,   dhdx__R,   hvar__R,   obsMat,   inputMat,   parVec,   covMat,   stateVec,   ode_timestep_size,   ode_timesteps,   bool_is_not_na_obsMat,   number_of_available_obs,   n,   m,   last_pred_id,   k_step_ahead,   ode_solver )"},{"path":"/reference/execute_ekf_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"export — execute_ekf_simulation","title":"export — execute_ekf_simulation","text":"export","code":""},{"path":"/reference/execute_ekf_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"export — execute_ekf_simulation","text":"","code":"execute_ekf_simulation(   f__R,   g__R,   dfdx__R,   h__R,   dhdx__R,   hvar__R,   obsMat,   inputMat,   parVec,   covMat,   stateVec,   ode_timestep_size,   ode_timesteps,   simulation_timestep_size,   simulation_timesteps,   bool_is_not_na_obsMat,   number_of_available_obs,   n,   m,   ng,   last_pred_id,   k_step_ahead,   ode_solver,   nsims )"},{"path":"/reference/plot.sdeTMB.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB.fit","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB.fit","text":"Basic summary objects class 'sdeTMB'","code":""},{"path":"/reference/plot.sdeTMB.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB.fit","text":"","code":"# S3 method for sdeTMB.fit plot(   fit,   plot.obs = 1,   pacf = FALSE,   extended = FALSE,   ggtheme = getggplot2theme() )"},{"path":"/reference/plot.sdeTMB.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB.fit","text":"plot.obs vector indicate observations plotted . multiple chosen list plots observation returned. pacf logical indicate whether partial autocorrelations returned. default FALSE case histogram returned instead. extended logical. TRUE additional information printed ggtheme ggplot2 theme use creating ggplot.","code":""},{"path":"/reference/plot.sdeTMB.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB.fit","text":"list plots","code":""},{"path":"/reference/plot.sdeTMB.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB","text":"Basic summary objects class 'sdeTMB'","code":""},{"path":"/reference/plot.sdeTMB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB","text":"","code":"# S3 method for sdeTMB plot(   object,   plot.obs = 1,   pacf = FALSE,   extended = FALSE,   ggtheme = getggplot2theme() )"},{"path":"/reference/plot.sdeTMB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB","text":"plot.obs vector indicate observations plotted . multiple chosen list plots observation returned. pacf logical indicate whether partial autocorrelations returned. default FALSE case histogram returned instead. extended logical. TRUE additional information printed ggtheme ggplot2 theme use creating ggplot.","code":""},{"path":"/reference/plot.sdeTMB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic summary of objects of class 'sdeTMB' — plot.sdeTMB","text":"huge amount information","code":""},{"path":"/reference/plot.sdeTMB.pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic summary of objects of class 'sdeTMB.pred' from predict — plot.sdeTMB.pred","title":"Basic summary of objects of class 'sdeTMB.pred' from predict — plot.sdeTMB.pred","text":"Basic summary objects class 'sdeTMB.pred' predict","code":""},{"path":"/reference/plot.sdeTMB.pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic summary of objects of class 'sdeTMB.pred' from predict — plot.sdeTMB.pred","text":"","code":"# S3 method for sdeTMB.pred plot(pred.data, n.ahead = 0, state.name = NULL, ...)"},{"path":"/reference/plot.sdeTMB.pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic summary of objects of class 'sdeTMB.pred' from predict — plot.sdeTMB.pred","text":"huge amount information","code":""},{"path":"/reference/print.sdeTMB.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic print of objects of class 'sdeTMB' — print.sdeTMB.fit","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB.fit","text":"Basic print objects class 'sdeTMB'","code":""},{"path":"/reference/print.sdeTMB.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB.fit","text":"","code":"# S3 method for sdeTMB.fit print(fit)"},{"path":"/reference/print.sdeTMB.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB.fit","text":"huge amount information","code":""},{"path":"/reference/print.sdeTMB.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic print of objects of class 'sdeTMB' — print.sdeTMB","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB","text":"Basic print objects class 'sdeTMB'","code":""},{"path":"/reference/print.sdeTMB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB","text":"","code":"# S3 method for sdeTMB print(object, ...)"},{"path":"/reference/print.sdeTMB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic print of objects of class 'sdeTMB' — print.sdeTMB","text":"huge amount information","code":""},{"path":"/reference/sdeTMB.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for the 'sdeTMB' R6 class — sdeTMB","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"following public methods used construct stochastic state space model system, consisting set stochastic differential equations (SDEs), one algebraic observation equations (AOEs). AOEs used infer information value (latent) states governed SDEs, thus must functions least one state.","code":""},{"path":"/reference/sdeTMB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"function returns object class R6 sdeTMB, can used define stochastic state space system.","code":""},{"path":[]},{"path":"/reference/sdeTMB.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"sdeTMB$new() sdeTMB$add_systems() sdeTMB$add_observations() sdeTMB$add_observation_variances() sdeTMB$add_inputs() sdeTMB$add_parameters() sdeTMB$add_algebraics() sdeTMB$set_initial_state() sdeTMB$set_lamperti() sdeTMB$set_modelname() sdeTMB$set_cppfile_directory() sdeTMB$set_map() sdeTMB$get_systems() sdeTMB$get_observations() sdeTMB$get_observation_variances() sdeTMB$get_algebraics() sdeTMB$get_initial_state() sdeTMB$get_parameters() sdeTMB$construct_nll() sdeTMB$estimate() sdeTMB$simulate() sdeTMB$predict() sdeTMB$print() sdeTMB$summary() sdeTMB$plot() sdeTMB$clone()","code":""},{"path":"/reference/sdeTMB.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Initialize private fields","code":""},{"path":"/reference/sdeTMB.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$new()"},{"path":"/reference/sdeTMB.html","id":"method-add-systems-","dir":"Reference","previous_headings":"","what":"Method add_systems()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Define add multiple stochastic differential equation governing process individual state variables form d<state> ~ f(t,<states>,<inputs>) * dt + g1(t,<states>,<inputs>) * dw1  + g2(t,<states>,<inputs>) * dw2 + ... + gN(t,<states>,<inputs>) * dwN f drift, g1, g2, ..., gN diffusions, differential brownian motions dw1, dw2, ..., dwN.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_systems(form, ...)"},{"path":"/reference/sdeTMB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"form formula specifying stochastic differential equation added system. ... additional formulas similar form specifying multiple equations .","code":""},{"path":"/reference/sdeTMB.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"# Specify Ornstein-Uhlenbeck Process add_systems(dx ~ theta * (mu - x + u) * dt + sigma * dw)"},{"path":"/reference/sdeTMB.html","id":"method-add-observations-","dir":"Reference","previous_headings":"","what":"Method add_observations()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Define add relationship observed variable system states. observation equation takes form <observation> ~ h(t,<states>,<inputs>) + e) h observation function, e normally distributed noise zero mean variance specified. observation variable present data provided calling estimate(.data) parameter estimation.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_observations(form, ..., obsnames = NULL)"},{"path":"/reference/sdeTMB.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"form formula class specifying obsevation equation added system. ... additional formulas identical form specify multiple observation equations time. obsnames character vector specifying name observation. observation left-hand side consists just single variable name (class 'call' instead 'name') given name form obs__# # number, unless obsnames provided.","code":""},{"path":"/reference/sdeTMB.html","id":"examples-1","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"#Specify observation directly as a latent state add_observations(y ~ x)  Specify observation as the sum of exponentials of two latent states add_observations(y ~ exp(x1) + exp(x2))"},{"path":"/reference/sdeTMB.html","id":"method-add-observation-variances-","dir":"Reference","previous_headings":"","what":"Method add_observation_variances()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Specify variance observation equation. defined observation variable y e.g. add_observations(y ~  h(t,<states>,<inputs>) pertubed Gaussian noise zero mean variance -specified using add_observation_variances(y ~ p(t,<states>,<inputs>). can instance declare add_observation_variances(y ~ sigma_x^2 sigma_x fixed effect parameter declared add_parameters.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_observation_variances(form, ...)"},{"path":"/reference/sdeTMB.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"form formula class specifying obsevation equation added system. ... additional formulas identical form specify multiple observation equations time.","code":""},{"path":"/reference/sdeTMB.html","id":"method-add-inputs-","dir":"Reference","previous_headings":"","what":"Method add_inputs()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Declare variables data inputs Declare whether variable contained system, observation observation variance equations input variable. e.g. system equation contains input variable u declared using add_inputs(u). input u must contained data.frame .data provided calling estimate predict methods.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_inputs(...)"},{"path":"/reference/sdeTMB.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"... variable names specifies name input variables defined system.","code":""},{"path":"/reference/sdeTMB.html","id":"method-add-parameters-","dir":"Reference","previous_headings":"","what":"Method add_parameters()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Declare variables (fixed effects) parameters specified model, specify initial optimizer value, well lower / upper bounds optimization. two ways declare parameters: can declare parameters using formulas .e. add_parameters(  theta = c(1,0,10), mu = c(0,-10,10) ). first value initial value optimizer, second value lower optimization bound third value upper optimization bound. can provide 3-column matrix rows corresponds different parameters, parameter names provided rownames matrix. columns values corresponds description vector format .","code":""},{"path":"/reference/sdeTMB.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_parameters(...)"},{"path":"/reference/sdeTMB.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"... named vector matrix described .","code":""},{"path":"/reference/sdeTMB.html","id":"method-add-algebraics-","dir":"Reference","previous_headings":"","what":"Method add_algebraics()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Add algebraic relations. Algebraic relations convenient way transform parameters equations. Ornstein-Uhlenbeck process rate parameter theta always positive, estimation log-domain good idea. Instead writing exp(theta) directly system equation one can transform log domain using algebraic relation add_algebraics(theta ~ exp(logtheta)). instances theta replaced exp(logtheta) compiling C++ function. Note must provide values logtheta now instead theta declaring parameters add_parameters","code":""},{"path":"/reference/sdeTMB.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$add_algebraics(form, ...)"},{"path":"/reference/sdeTMB.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"form formula specifying stochastic differential equation(s) added system. ... additional formulas similar form specifying multiple equations .","code":""},{"path":"/reference/sdeTMB.html","id":"method-set-initial-state-","dir":"Reference","previous_headings":"","what":"Method set_initial_state()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Declare initial state values .e. mean covariance system states.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$set_initial_state(initial.state, estimate = FALSE)"},{"path":"/reference/sdeTMB.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"initial.state named list two entries 'x0' 'p0' containing initial state covariance state estimate boolean value indicates whether initial conditions shall estimated fixed effects parameters. provided mean covariance used initial guesses","code":""},{"path":"/reference/sdeTMB.html","id":"method-set-lamperti-","dir":"Reference","previous_headings":"","what":"Method set_lamperti()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Set Lamperti Transformation provided system equations state dependent diffusion available ways advantageous perform transformation remove state dependence. comes cost complicated drift function. following types state-dependence currently supported 'identity' - diffusion state-independent (default) 'log' - diffusion proportional x * dw 'logit' - diffusion proportional x * (1-x) * dw 'sqrt-logit' - diffusion proportional sqrt(x * (1-x)) * dw","code":""},{"path":"/reference/sdeTMB.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$set_lamperti(transforms, states = NULL)"},{"path":"/reference/sdeTMB.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"transforms character vector - one either \"identity, \"log\", \"logit\", \"sqrt-logit\" states vector state names specified transformations applied .","code":""},{"path":"/reference/sdeTMB.html","id":"method-set-modelname-","dir":"Reference","previous_headings":"","what":"Method set_modelname()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Set modelname used create C++ file TMB calling TMB::MakeADFun (negative log) likelihood function created directory specified set_cppfile_directory method name <modelname>.cpp","code":""},{"path":"/reference/sdeTMB.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$set_modelname(name)"},{"path":"/reference/sdeTMB.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"name string defining model name.","code":""},{"path":"/reference/sdeTMB.html","id":"method-set-cppfile-directory-","dir":"Reference","previous_headings":"","what":"Method set_cppfile_directory()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Set path directory constructed C++ file created. specify entire path, unless want construct subfolder current working directory - can call e.g. set_cppfile_directory(\"folder_in_current_wd\").","code":""},{"path":"/reference/sdeTMB.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$set_cppfile_directory(directory)"},{"path":"/reference/sdeTMB.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"directory string specifying local directory","code":""},{"path":"/reference/sdeTMB.html","id":"method-set-map-","dir":"Reference","previous_headings":"","what":"Method set_map()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Enable maximum posterior (MAP) estimation. Adds maximum posterior contribution (negative log) likelihood function evaluating fixed effects parameters multivariate Gaussian mean covariance provided.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$set_map(mean, cov)"},{"path":"/reference/sdeTMB.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"mean mean vector Gaussian prior parameter distribution cov covariance matrix Gaussian prior parameter distribution","code":""},{"path":"/reference/sdeTMB.html","id":"method-get-systems-","dir":"Reference","previous_headings":"","what":"Method get_systems()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Retrieve system equations.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_systems()"},{"path":"/reference/sdeTMB.html","id":"method-get-observations-","dir":"Reference","previous_headings":"","what":"Method get_observations()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Retrieve observation equations.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_observations()"},{"path":"/reference/sdeTMB.html","id":"method-get-observation-variances-","dir":"Reference","previous_headings":"","what":"Method get_observation_variances()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Retrieve observation variances","code":""},{"path":"/reference/sdeTMB.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_observation_variances()"},{"path":"/reference/sdeTMB.html","id":"method-get-algebraics-","dir":"Reference","previous_headings":"","what":"Method get_algebraics()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Retrieve algebraic relations","code":""},{"path":"/reference/sdeTMB.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_algebraics()"},{"path":"/reference/sdeTMB.html","id":"method-get-initial-state-","dir":"Reference","previous_headings":"","what":"Method get_initial_state()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Retrieve initially set state covariance","code":""},{"path":"/reference/sdeTMB.html","id":"usage-16","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_initial_state()"},{"path":"/reference/sdeTMB.html","id":"method-get-parameters-","dir":"Reference","previous_headings":"","what":"Method get_parameters()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Get initial (estimated) parameters.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-17","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$get_parameters(type = \"all\", value = \"all\")"},{"path":"/reference/sdeTMB.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"type one \"\", free\" \"fixed\" parameters. value one \"\", initial\", \"estimate\", \"lower\" \"upper\"","code":""},{"path":"/reference/sdeTMB.html","id":"method-construct-nll-","dir":"Reference","previous_headings":"","what":"Method construct_nll()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Construct extract function handlers negative log likelihood function. handlers TMB's MakeADFun constructed returned. enables user e.g. choose optimization algorithm, just control optimization workflow.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-18","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$construct_nll(   data,   method = \"ekf\",   ode.solver = \"rk4\",   ode.timestep = NULL,   loss = \"quadratic\",   loss_c = 3,   unscented_hyperpars = NULL,   compile = FALSE,   silent = FALSE )"},{"path":"/reference/sdeTMB.html","id":"arguments-12","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data data.frame containing time-vector 't', observations inputs. observations can take NA-values. method character vector - one either \"ekf\", \"ukf\" \"tmb\". Sets estimation method. package three available methods implemented: natural TMB-style formulation latent states considered random effects integrated using Laplace approximation. method yields gradient (negative log) likelihood function respect fixed effects optimization. method slower although probably precision advantages, allows non-Gaussian observation noise (yet implemented). One-step / K-step residuals yet available package. (Continous-Discrete) Extended Kalman Filter system dynamics linearized handle potential non-linearities. computationally fastest method. (Continous-Discrete) Unscented Kalman Filter. higher order non-linear Kalman Filter improves mean covariance estimates system display high nonlinearity, circumvents necessity compute jacobian drift observation functions. package features currently available kalman filters, TMB limited parameter estimation. particular, straight-forward obtain k-step-ahead predictions methods (use predict S3 method), stochastic simulation also available cases long prediction horizons sought, normality assumption inaccurate. ode.solver Sets ODE solver used Kalman Filter methods solving moment differential equations. default \"euler\" Forward Euler method, alternatively classical 4th order Runge Kutta method available via \"rk4\". ode.timestep time-step used filtering schemes. time-step two different uses depending chosen method. Kalman Filters: time-step used numerically solving moment differential equations. Laplace Approximation: time-step used Euler-Maruyama simulation scheme simulating sample path stochastic differential equation, serves link together latent (random effects) states. defined step-size used calculate number steps observation time-points defined provided data. calculated number steps larger N.01 N integer, time-step reduced exactly N+1 steps taken observations step-size used two following ways depending chosen method: Kalman filters: time-step used step-size numerical Forward-Euler scheme compute prior state mean covariance estimate final time solution first second order moment differential equations. TMB method: time-step used step-size Euler-Maruyama scheme simulating sample path stochastic differential equation, serves link together latent (random effects) states. loss character vector. Sets loss function type (implemented kalman filter methods). loss function per default quadratic one-step residauls natural Gaussian (negative log) likelihood evaluated, tails distribution considered small .e. outliers weighted much, one can choose loss functions accounts . three available types available: Quadratic loss (quadratic). Quadratic-Linear (huber) Quadratic-Constant (tukey) cutoff Huber Tukey loss functions determined provided cutoff parameter loss_c. implementations losses approximations (pseudo-huber sigmoid approxmation respectively) smooth derivatives. loss_c cutoff value huber tukey loss functions. Defaults c=3 unscented_hyperpars three hyper-parameters alpha, beta kappa defining unscented transformation. compile boolean value. default (FALSE) compile C++ objective function assume already compiled corresponds specified model object. user's responsibility ensure correspondence specified model precompiled C++ object. precompiled C++ object found specified directory .e. <cppfile_directory>/<modelname>/(dll/) compile flag set TRUE. user makes changes system equations, observation equations, observation variances, algebraic relations lamperi transformations C++ object recompiled. silent logical value whether suppress printed messages 'Checking Data', 'Building Model', etc. Default behaviour (FALSE) print messages.","code":""},{"path":"/reference/sdeTMB.html","id":"method-estimate-","dir":"Reference","previous_headings":"","what":"Method estimate()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Estimate fixed effects parameters specified model.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-19","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$estimate(   data,   method = \"ekf\",   ode.solver = \"rk4\",   ode.timestep = NULL,   loss = \"quadratic\",   loss_c = 3,   use.hessian = FALSE,   control = list(trace = 1, iter.max = 1e+05, eval.max = 1e+05),   unscented_hyperpars = NULL,   calculate.laplace.onestep.residuals = FALSE,   unconstrained.optim = FALSE,   compile = FALSE,   silent = FALSE )"},{"path":"/reference/sdeTMB.html","id":"arguments-13","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data data.frame containing time-vector 't', observations inputs. observations can take NA-values. method character vector - one either \"ekf\", \"ukf\" \"tmb\". Sets estimation method. package three available methods implemented: natural TMB-style formulation latent states considered random effects integrated using Laplace approximation. method yields gradient (negative log) likelihood function respect fixed effects optimization. method slower although probably precision advantages, allows non-Gaussian observation noise (yet implemented). One-step / K-step residuals yet available package. (Continous-Discrete) Extended Kalman Filter system dynamics linearized handle potential non-linearities. computationally fastest method. (Continous-Discrete) Unscented Kalman Filter. higher order non-linear Kalman Filter improves mean covariance estimates system display high nonlinearity, circumvents necessity compute jacobian drift observation functions. package features currently available kalman filters, TMB limited parameter estimation. particular, straight-forward obtain k-step-ahead predictions methods (use predict S3 method), stochastic simulation also available cases long prediction horizons sought, normality assumption inaccurate. ode.solver Sets ODE solver used Kalman Filter methods solving moment differential equations. default \"euler\" Forward Euler method, alternatively classical 4th order Runge Kutta method available via \"rk4\". ode.timestep numeric value. Sets time step-size numerical filtering schemes. defined step-size used calculate number steps observation time-points defined provided data. calculated number steps larger N.01 N integer, time-step reduced exactly N+1 steps taken observations step-size used two following ways depending chosen method: Kalman filters: time-step used step-size numerical Forward-Euler scheme compute prior state mean covariance estimate final time solution first second order moment differential equations. TMB method: time-step used step-size Euler-Maruyama scheme simulating sample path stochastic differential equation, serves link together latent (random effects) states. loss character vector. Sets loss function type (implemented kalman filter methods). loss function per default quadratic one-step residauls natural Gaussian (negative log) likelihood evaluated, tails distribution considered small .e. outliers weighted much, one can choose loss functions accounts . three available types available: Quadratic loss (quadratic). Quadratic-Linear (huber) Quadratic-Constant (tukey) cutoff Huber Tukey loss functions determined provided cutoff parameter loss_c. implementations losses approximations (pseudo-huber sigmoid approxmation respectively) smooth derivatives. loss_c cutoff value huber tukey loss functions. Defaults c=3 use.hessian boolean value. default (TRUE) causes optimization algorithm stats::nlminb use fixed effects hessian (negative log) likelihood performing optimization. feature available kalman filter methods without random effects. control list control parameters parsed nlminb control argument. See ?stats::nlminb information unscented_hyperpars three hyper-parameters alpha, beta kappa defining unscented transformation. calculate.laplace.onestep.residuals boolean - whether calculate one-step ahead residuls using method oneStepPredict. unconstrained.optim boolean value. TRUE optimization carried unconstrained .e. without parameter bounds specified add_parameters. compile boolean value. default (FALSE) compile C++ objective function assume already compiled corresponds specified model object. user's responsibility ensure correspondence specified model precompiled C++ object. precompiled C++ object found specified directory .e. <cppfile_directory>/<modelname>/(dll/) compile flag set TRUE. user makes changes system equations, observation equations, observation variances, algebraic relations lamperi transformations C++ object recompiled. silent logical value whether suppress printed messages 'Checking Data', 'Building Model', etc. Default behaviour (FALSE) print messages.","code":""},{"path":"/reference/sdeTMB.html","id":"method-simulate-","dir":"Reference","previous_headings":"","what":"Method simulate()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Perform prediction/filtration obtain state mean covariance estimates. predictions obtained solving moment equations n.ahead steps forward time using current step posterior state estimate initial condition.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-20","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$simulate(   data,   initial.state = self$get_initial_state(),   pars = NULL,   k.ahead = 1,   n.sims = 100,   return.k.ahead = NULL,   method = \"ekf\",   ode.timestep = NULL,   simulation.timestep = NULL,   ode.solver = \"rk4\",   return.covariance = TRUE,   unscented_hyperpars = NULL,   silent = FALSE )"},{"path":"/reference/sdeTMB.html","id":"arguments-14","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data data.frame containing time-vector 't', observations inputs. observations can take NA-values. initial.state named list two entries 'x0' 'p0' containing initial state covariance state pars fixed parameter vector parsed objective function prediction/filtration. default parameter values used initial parameters provided add_parameters, unless estimate function run, default values found optimum. k.ahead integer specifying desired number time-steps (determined provided data time-vector) predictions made (integrating moment ODEs forward time without data updates). n.sims number simulations return.k.ahead numeric vector integers specifying n.ahead predictions returned. method natural TMB-style formulation latent states considered random effects integrated using Laplace approximation. method yields gradient (negative log) likelihood function respect fixed effects optimization. method slower although probably precision advantages, allows non-Gaussian observation noise (yet implemented). One-step / K-step residuals yet available package. (Continous-Discrete) Extended Kalman Filter system dynamics linearized handle potential non-linearities. computationally fastest method. (Continous-Discrete) Unscented Kalman Filter. higher order non-linear Kalman Filter improves mean covariance estimates system display high nonlinearity, circumvents necessity compute jacobian drift observation functions. package features currently available kalman filters, TMB limited parameter estimation. particular, straight-forward obtain k-step-ahead predictions methods (use predict S3 method), stochastic simulation also available cases long prediction horizons sought, normality assumption inaccurate ode.timestep numeric value. Sets time step-size numerical filtering schemes. defined step-size used calculate number steps observation time-points defined provided data. calculated number steps larger N.01 N integer, time-step reduced exactly N+1 steps taken observations step-size used two following ways depending chosen method: Kalman filters: time-step used step-size numerical Forward-Euler scheme compute prior state mean covariance estimate final time solution first second order moment differential equations. TMB method: time-step used step-size Euler-Maruyama scheme simulating sample path stochastic differential equation, serves link together latent (random effects) states. simulation.timestep timestep used euler-maruyama scheme ode.solver Sets ODE solver used Kalman Filter methods solving moment differential equations. default \"euler\" Forward Euler method, alternatively classical 4th order Runge Kutta method available via \"rk4\". return.covariance booelan value indicate whether covariance (instead correlation) returned. unscented_hyperpars three hyper-parameters alpha, beta kappa defining unscented transformation. silent logical value whether suppress printed messages 'Checking Data', 'Building Model', etc. Default behaviour (FALSE) print messages.","code":""},{"path":"/reference/sdeTMB.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data.frame contains time step posterior state estimate time.step (k = 0), prior state predictions (k = 1,...,n.ahead). return.covariance = TRUE state covariance/correlation matrix returned, otherwise marginal variances returned.","code":""},{"path":"/reference/sdeTMB.html","id":"method-predict-","dir":"Reference","previous_headings":"","what":"Method predict()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Perform prediction/filtration obtain state mean covariance estimates. predictions obtained solving moment equations n.ahead steps forward time using current step posterior state estimate initial condition.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-21","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$predict(   data,   initial.state = self$get_initial_state(),   pars = NULL,   k.ahead = 1,   return.k.ahead = NULL,   method = \"ekf\",   ode.timestep = NULL,   ode.solver = \"rk4\",   return.covariance = TRUE,   unscented_hyperpars = NULL,   silent = FALSE )"},{"path":"/reference/sdeTMB.html","id":"arguments-15","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data data.frame containing time-vector 't', observations inputs. observations can take NA-values. initial.state named list two entries 'x0' 'p0' containing initial state covariance state pars fixed parameter vector parsed objective function prediction/filtration. default parameter values used initial parameters provided add_parameters, unless estimate function run, default values found optimum. k.ahead integer specifying desired number time-steps (determined provided data time-vector) predictions made (integrating moment ODEs forward time without data updates). return.k.ahead numeric vector integers specifying n.ahead predictions returned. method natural TMB-style formulation latent states considered random effects integrated using Laplace approximation. method yields gradient (negative log) likelihood function respect fixed effects optimization. method slower although probably precision advantages, allows non-Gaussian observation noise (yet implemented). One-step / K-step residuals yet available package. (Continous-Discrete) Extended Kalman Filter system dynamics linearized handle potential non-linearities. computationally fastest method. (Continous-Discrete) Unscented Kalman Filter. higher order non-linear Kalman Filter improves mean covariance estimates system display high nonlinearity, circumvents necessity compute jacobian drift observation functions. package features currently available kalman filters, TMB limited parameter estimation. particular, straight-forward obtain k-step-ahead predictions methods (use predict S3 method), stochastic simulation also available cases long prediction horizons sought, normality assumption inaccurate. ode.timestep numeric value. Sets time step-size numerical filtering schemes. defined step-size used calculate number steps observation time-points defined provided data. calculated number steps larger N.01 N integer, time-step reduced exactly N+1 steps taken observations step-size used two following ways depending chosen method: Kalman filters: time-step used step-size numerical Forward-Euler scheme compute prior state mean covariance estimate final time solution first second order moment differential equations. TMB method: time-step used step-size Euler-Maruyama scheme simulating sample path stochastic differential equation, serves link together latent (random effects) states. ode.solver Sets ODE solver used Kalman Filter methods solving moment differential equations. default \"euler\" Forward Euler method, alternatively classical 4th order Runge Kutta method available via \"rk4\". return.covariance booelan value indicate whether covariance (instead correlation) returned. unscented_hyperpars three hyper-parameters alpha, beta kappa defining unscented transformation. silent logical value whether suppress printed messages 'Checking Data', 'Building Model', etc. Default behaviour (FALSE) print messages.","code":""},{"path":"/reference/sdeTMB.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"data.frame contains time step posterior state estimate time.step (k = 0), prior state predictions (k = 1,...,n.ahead). return.covariance = TRUE state covariance/correlation matrix returned, otherwise marginal variances returned.","code":""},{"path":"/reference/sdeTMB.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Function print model object","code":""},{"path":"/reference/sdeTMB.html","id":"usage-22","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$print()"},{"path":"/reference/sdeTMB.html","id":"method-summary-","dir":"Reference","previous_headings":"","what":"Method summary()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Summary function fit","code":""},{"path":"/reference/sdeTMB.html","id":"usage-23","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$summary(correlation = FALSE)"},{"path":"/reference/sdeTMB.html","id":"arguments-16","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"correlation boolean value. default (FALSE) provide fixed effects parameter correlation matrix.","code":""},{"path":"/reference/sdeTMB.html","id":"method-plot-","dir":"Reference","previous_headings":"","what":"Method plot()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"Function print model object","code":""},{"path":"/reference/sdeTMB.html","id":"usage-24","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$plot(   plot.obs = 1,   pacf = FALSE,   extended = FALSE,   ggtheme = getggplot2theme() )"},{"path":"/reference/sdeTMB.html","id":"arguments-17","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"plot.obs vector indicate observations plotted . multiple chosen list plots observation returned. pacf logical indicate whether partial autocorrelations returned. default FALSE case histogram returned instead. extended logical. TRUE additional information printed ggtheme ggplot2 theme use creating ggplot.","code":""},{"path":"/reference/sdeTMB.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"objects class cloneable method.","code":""},{"path":"/reference/sdeTMB.html","id":"usage-25","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"","code":"sdeTMB$clone(deep = FALSE)"},{"path":"/reference/sdeTMB.html","id":"arguments-18","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for the 'sdeTMB' R6 class — sdeTMB","text":"deep Whether make deep clone.","code":""},{"path":[]},{"path":"/reference/summary.sdeTMB.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic summary of objects of class 'sdeTMB' — summary.sdeTMB","title":"Basic summary of objects of class 'sdeTMB' — summary.sdeTMB","text":"Basic summary objects class 'sdeTMB'","code":""},{"path":"/reference/summary.sdeTMB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic summary of objects of class 'sdeTMB' — summary.sdeTMB","text":"","code":"# S3 method for sdeTMB summary(object, correlation = FALSE)"},{"path":"/reference/summary.sdeTMB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic summary of objects of class 'sdeTMB' — summary.sdeTMB","text":"huge amount information","code":""},{"path":"/news/index.html","id":"sdetmb-100","dir":"Changelog","previous_headings":"","what":"sdeTMB 1.0.0","title":"sdeTMB 1.0.0","text":"first release package","code":""}]
