<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sdeTMB">
<title>Getting started • sdeTMB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Mukta-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="sdeTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sdeTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/sdeTMB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/construct_nll.html">construct_nll: How to extract function handlers, and choosing your own optimizer</a>
    <a class="dropdown-item" href="../articles/estimate.html">estimate: Estimating model parameters and states</a>
    <a class="dropdown-item" href="../articles/observation_equations.html">observations: Using functions on the left-hand side</a>
    <a class="dropdown-item" href="../articles/predict.html">predict: Forecasting the model states and observations.</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phillipbvetter/sdeTMB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started</h1>
                        <h4 data-toc-skip class="author"></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phillipbvetter/sdeTMB/blob/HEAD/vignettes/sdeTMB.Rmd" class="external-link"><code>vignettes/sdeTMB.Rmd</code></a></small>
      <div class="d-none name"><code>sdeTMB.Rmd</code></div>
    </div>

    
    
<p>Let’s get starting using <code>sdeTMB</code>!</p>
<p>We shall assume that you have some time series <code>data</code>, and
a stochastic differential equation model which you believe can be used
to model that data (or some latent variable that can be linked to your
data).</p>
<p>Here we consider the Ornstein-Uhlenbeck process <span class="math display">\[
\mathrm{d}X_{t} = \theta (\mu - X_{t}) \, \mathrm{d}t \, + \sigma_{X} \,
\mathrm{d}B_{t}
\]</span> where <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma_x\)</span> are (fixed effects) parameters
in the model to be estimated.</p>
<p>We assume that we have direct observations of the state <span class="math inline">\(X_{t}\)</span> i.e. the observation equation is
<span class="math display">\[
Y_{t_{k}} = X_{t_{k}} + \varepsilon_{t_{k}} \qquad \varepsilon_{t_{k}}
\sim \mathcal{N}(0,\sigma_{Y}^{2} \cdot U_{t_{k}})
\]</span> and the residuals are normally distributed with variance <span class="math inline">\(\sigma_{Y}^{2} \cdot U_{t}\)</span>, where <span class="math inline">\(\sigma_{Y}\)</span> is a fixed effect (parameter)
which should also be estimated, and <span class="math inline">\(U_{t}\)</span> is an input. The input is added
purely for the sake of this example. It could for instance be a vector
<span class="math display">\[
U_{t_{i}} = \left\{ 1,2,1,2,1,2,\cdots \right\}
\]</span> so that some observations have a larger variance than others,
i.e. we believe them to be a less accurate measurement of <span class="math inline">\(Y\)</span>.</p>
<div class="section level2">
<h2 id="initialising">Initialising<a class="anchor" aria-label="anchor" href="#initialising"></a>
</h2>
<hr>
<p>We initialise a <code>sdeTMB</code> model object using</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phillipbvetter/sdeTMB" class="external-link">sdeTMB</a></span><span class="op">)</span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="va"><a href="../reference/sdeTMB.html">sdeTMB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can print the object to see what kind of model it contains</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Stochastic State Space Model:                         </span></span>
<span><span class="co">## Name         sdeTMB_model</span></span>
<span><span class="co">## States                  0</span></span>
<span><span class="co">## Diffusions              0</span></span>
<span><span class="co">## Observations            0</span></span>
<span><span class="co">## Inputs                  0</span></span>
<span><span class="co">## Parameters              0</span></span></code></pre>
<p>We see that the model is called <code>sde_model</code> (default), and
there are no states, diffusions, observations, inputs or parameters
currently registered. The name is used to name the <code>C++</code> file
that will be created locally, and to later recognize the compiled model
object.</p>
</div>
<div class="section level2">
<h2 id="add-system-equations">Add system equations<a class="anchor" aria-label="anchor" href="#add-system-equations"></a>
</h2>
<hr>
<p>We can begin by adding the desired stochastic differential equation
to the object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_systems</span><span class="op">(</span><span class="va">dX</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span> <span class="op">-</span> <span class="va">X</span><span class="op">)</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma_x</span> <span class="op">*</span> <span class="va">dw</span><span class="op">)</span></span></code></pre></div>
<p>We note that the drift term ends with <code>*dt</code> and diffusions
are specified by <code>dw</code> or <code>dw#</code> where
<code>#</code> can be any sequence of numbers.</p>
</div>
<div class="section level2">
<h2 id="add-observation-equations">Add observation equations<a class="anchor" aria-label="anchor" href="#add-observation-equations"></a>
</h2>
<hr>
<p>We must also add the observation equation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p>The observations associated with <code>Y</code> in the
<code>data</code> should also be named <code>Y</code>.</p>
</div>
<div class="section level2">
<h2 id="add-observation-variances">Add observation variances<a class="anchor" aria-label="anchor" href="#add-observation-variances"></a>
</h2>
<hr>
<p>For every observation variable we must also specify the variance of
the normally distributed residuals for that observation equation</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observation_variances</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">sigma_y</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">U</span><span class="op">)</span></span></code></pre></div>
<p>The variable name on the left-hand side of the formula must match a
name previously defined via <code>add_observations</code>, and the
variance is associated with that observation equation.</p>
<p>Let’s inspect the model object again</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Stochastic State Space Model:                         </span></span>
<span><span class="co">## Name         sdeTMB_model</span></span>
<span><span class="co">## States                  1</span></span>
<span><span class="co">## Diffusions              1</span></span>
<span><span class="co">## Observations            1</span></span>
<span><span class="co">## Inputs                  0</span></span>
<span><span class="co">## Parameters              0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## System Equations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   dX ~ theta * (mu - X) * dt + sigma_x * dw </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Observation Equations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Y:  Y ~ X + e   e ~ N(0, sigma_y^2 * U)</span></span></code></pre>
<p>So now we have specified one state <span class="math inline">\(X\)</span> and an observation <span class="math inline">\(Y\)</span>. The diffusions count the number of
<span class="math inline">\(\mathrm{d}\omega_{i}\)</span> terms. A
single equation can have multiple diffusion terms
i.e. <code>sigma_1 * dw1 + sigma_2*dw2</code>). We also note that there
are no inputs and no parameter specified yet.</p>
</div>
<div class="section level2">
<h2 id="add-inputs">Add inputs<a class="anchor" aria-label="anchor" href="#add-inputs"></a>
</h2>
<hr>
<p>We tell the model which variable names are inputs via</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_inputs</span><span class="op">(</span><span class="va">U</span><span class="op">)</span></span></code></pre></div>
<p>The input values should be provided in the <code>data</code>, with
the same name, similar to the observations.</p>
</div>
<div class="section level2">
<h2 id="add-parameters">Add parameters<a class="anchor" aria-label="anchor" href="#add-parameters"></a>
</h2>
<hr>
<p>We must also specify the (fixed effects) parameters, together with
their initial value and lower/upper bound, for the optimization.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_parameters</span><span class="op">(</span></span>
<span>  theta   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">5</span>,    lower <span class="op">=</span> <span class="fl">0</span>,    upper <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  mu      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">0</span>,    lower <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,  upper <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  sigma_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  sigma_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can fix a parameter value (so the parameter becomes a constant) by
supplying just a single value. It is usually difficult to identify both
of the noise parameters <span class="math inline">\(\left(\sigma_{X},\sigma_{Y}\right)\)</span> in
practice, so lets assume that we want to fix <span class="math inline">\(\sigma_{Y}\)</span>. This is done via</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_parameters</span><span class="op">(</span></span>
<span>  sigma_y  <span class="op">=</span> <span class="fl">1e-1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s inspect the model object again, and see that inputs and
parameters (both non-fixed and fixed) have been registered.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Stochastic State Space Model:                         </span></span>
<span><span class="co">## Name         sdeTMB_model</span></span>
<span><span class="co">## States                  1</span></span>
<span><span class="co">## Diffusions              1</span></span>
<span><span class="co">## Observations            1</span></span>
<span><span class="co">## Inputs                  1</span></span>
<span><span class="co">## Parameters              4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## System Equations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   dX ~ theta * (mu - X) * dt + sigma_x * dw </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Observation Equations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Y:  Y ~ X + e   e ~ N(0, sigma_y^2 * U) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##   theta, mu, sigma_x, sigma_y</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed Parameters:</span></span>
<span><span class="co">##   sigma_y</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="set-initial-state-and-covariance">Set initial state and covariance<a class="anchor" aria-label="anchor" href="#set-initial-state-and-covariance"></a>
</h2>
<hr>
<p>The last thing to do before we can perform estimation is to set the
initial value of the state(s) and its associated (co)variance. These two
inputs are adequate since we assume a normally distributed state. The
choice of value should reflect ones belief in the initial state, but it
is most often a ballpark figure.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">set_initial_state</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">3</span>, cov<span class="op">=</span><span class="fl">1e-1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that we use <code>diag</code> to construct a 1x1 matrix for the
covariance, as required by the method.</p>
</div>
<div class="section level2">
<h2 id="fit-model-parameters-to-data">Fit model parameters to data<a class="anchor" aria-label="anchor" href="#fit-model-parameters-to-data"></a>
</h2>
<hr>
<p>We are now ready to perform state filtration and parameter
estimation. We first construct some fake data by simulating paths of the
Ornstein-Uhlenbeck process using the <a href="https://en.wikipedia.org/wiki/Euler%E2%80%93Maruyama_method" class="external-link">Euler-Maruyama
scheme</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Choosing parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">theta</span><span class="op">=</span><span class="fl">10</span>; <span class="va">mu</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_x</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_y</span><span class="op">=</span><span class="fl">1e-1</span></span>
<span> </span>
<span><span class="co"># Creating simulation path</span></span>
<span><span class="va">dt.sim</span> <span class="op">=</span> <span class="fl">1e-3</span></span>
<span><span class="va">t.sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.sim</span><span class="op">)</span></span>
<span><span class="va">dw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt.sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">*</span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">dt.sim</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract observations from simulation and add noise</span></span>
<span><span class="va">dt.obs</span> <span class="op">=</span> <span class="fl">1e-2</span></span>
<span><span class="va">t.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.obs</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">t.sim</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">t.obs</span><span class="op">]</span> <span class="op">+</span> <span class="va">sigma_y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data.frame</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="va">t.obs</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The data must contain a time column named <code>t</code> and columns
for each of the specified inputs and observations.</p>
<p>We pass the <code>data</code> to the <code>estimate</code> method.
The method will build and compile a generated <code>C++</code> function
for the negative log-likelihood, check if the supplied data contains all
necessary variables, construct the objective function (the computational
tree must be build for automatic differentiation) and then start the
optimization.</p>
<p>The output generated during the optimization is the objective
(negativ log-likelihood) value and parameter values at the current step.
The optimizer used in the package is <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code>. This
optimizer is great because of its robustness and ability to use the
objective function hessian unlike e.g. ‘stats::optim’</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">estimate</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Building model...</span></span></code></pre>
<pre><code><span><span class="co">## Checking data...</span></span></code></pre>
<pre><code><span><span class="co">## Constructing objective function...</span></span></code></pre>
<pre><code><span><span class="co">## ...took: 0.01 seconds.</span></span></code></pre>
<pre><code><span><span class="co">## Minimizing the negative log-likelihood...</span></span></code></pre>
<pre><code><span><span class="co">##   0:     818.68776:  5.00000  0.00000 0.100000</span></span>
<span><span class="co">##   1:    -24.103906:  4.97527 0.144197  1.08924</span></span>
<span><span class="co">##   2:    -28.328685:  4.90919 0.634803  1.01897</span></span>
<span><span class="co">##   3:    -29.207179:  5.37297 0.821070  1.00446</span></span>
<span><span class="co">##   4:    -29.456330:  6.88456  1.17214 0.993856</span></span>
<span><span class="co">##   5:    -30.458098:  6.57835 0.975504  1.01495</span></span>
<span><span class="co">##   6:    -31.234909:  7.32661 0.961485  1.03777</span></span>
<span><span class="co">##   7:    -33.289229:  10.3202  1.00995  1.11343</span></span>
<span><span class="co">##   8:    -34.206473:  13.9863  1.11028  1.19968</span></span>
<span><span class="co">##   9:    -34.404517:  15.1360  1.04697  1.24056</span></span>
<span><span class="co">##  10:    -34.445598:  15.3060  1.07129  1.24149</span></span>
<span><span class="co">##  11:    -34.446681:  15.4313  1.07217  1.24460</span></span>
<span><span class="co">##  12:    -34.447225:  15.4899  1.07227  1.24584</span></span>
<span><span class="co">##  13:    -34.448679:  15.5925  1.07247  1.24735</span></span>
<span><span class="co">##  14:    -34.452034:  15.7461  1.07274  1.24803</span></span>
<span><span class="co">##  15:    -34.459028:  15.9476  1.07305  1.24525</span></span>
<span><span class="co">##  16:    -34.469519:  16.0951  1.07318  1.23518</span></span>
<span><span class="co">##  17:    -34.478453:  16.0313  1.07286  1.22001</span></span>
<span><span class="co">##  18:    -34.481612:  15.8386  1.07235  1.21104</span></span>
<span><span class="co">##  19:    -34.481942:  15.7524  1.07216  1.21018</span></span>
<span><span class="co">##  20:    -34.481951:  15.7436  1.07215  1.21053</span></span>
<span><span class="co">##  21:    -34.481951:  15.7437  1.07215  1.21057</span></span>
<span><span class="co">##  22:    -34.481951:  15.7438  1.07215  1.21057</span></span></code></pre>
<pre><code><span><span class="co">##   Optimization finished!:</span></span>
<span><span class="co">##             Elapsed time: 0.004 seconds.</span></span>
<span><span class="co">##             The objective value is: -3.448195e+01</span></span>
<span><span class="co">##             The maximum gradient component is: 1e-06</span></span>
<span><span class="co">##             The convergence message is: relative convergence (4)</span></span>
<span><span class="co">##             Iterations: 22</span></span>
<span><span class="co">##             Evaluations: Fun: 24 Grad: 23</span></span>
<span><span class="co">##             See stats::nlminb for available tolerance/control arguments.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="important-note-for-model-changes">
<strong>Important Note for Model Changes</strong><a class="anchor" aria-label="anchor" href="#important-note-for-model-changes"></a>
</h2>
<hr>
<p>If you change the model at a later stage but retain the same model
name, then you need to recompile the <code>C++</code> objective
function. You can do this like so:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">estimate</span><span class="op">(</span><span class="va">data</span>, compile<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If you receive error messages when calling <code>estimate</code>
regarding variables that are not in your specified model, it is likely
because you forgot to recompile.</p>
</div>
<div class="section level2">
<h2 id="parameter-estimates">Parameter estimates<a class="anchor" aria-label="anchor" href="#parameter-estimates"></a>
</h2>
<hr>
<p>Let’s inspect results from the estimation.</p>
<p>We can print the <code>fit</code> object to see a standard
coefficient matrix for the parameter estimates.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coefficent Matrix </span></span>
<span><span class="co">##          Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">## theta   15.743756   3.806401  4.1361 7.366e-05 ***</span></span>
<span><span class="co">## mu       1.072147   0.081688 13.1249 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## sigma_x  1.210571   0.160547  7.5403 2.183e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>We can see the parameter estimate and the associated standard error
together with the t-test statistic and P-value associated with the
standard null-hypothesis <span class="math display">\[
H_{0}: p = 0 \\
H_{1}: p \neq 0
\]</span> Note that the true parameter values were set during the
simulation step as <span class="math inline">\(\theta = 10\)</span>,
<span class="math inline">\(\mu=1\)</span> and <span class="math inline">\(\sigma_{X} = 1\)</span>.</p>
<p>The parameter values, standard deviations and covariance matrix can
be extracted via:</p>
<p>The estimated (fixed) parameters:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">par.fixed</span></span></code></pre></div>
<pre><code><span><span class="co">##     theta        mu   sigma_x </span></span>
<span><span class="co">## 15.743756  1.072147  1.210571</span></span></code></pre>
<p>The standard deviations of the (fixed) parameters:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">sd.fixed</span></span></code></pre></div>
<pre><code><span><span class="co">##      theta         mu    sigma_x </span></span>
<span><span class="co">## 3.80640122 0.08168822 0.16054743</span></span></code></pre>
<p>The covariance of the (fixed) parameters:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">cov.fixed</span></span></code></pre></div>
<pre><code><span><span class="co">##              theta          mu     sigma_x</span></span>
<span><span class="co">## theta   14.4886902 0.085360603 0.210293731</span></span>
<span><span class="co">## mu       0.0853606 0.006672965 0.001238231</span></span>
<span><span class="co">## sigma_x  0.2102937 0.001238231 0.025775476</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="state-estimates">State estimates<a class="anchor" aria-label="anchor" href="#state-estimates"></a>
</h2>
<hr>
<p>We can also plot prior and posterior state estimates The prior state
estimate is the resulting estimate purely from integrating the mean and
covariance of the SDE system forward in time, while the posterior state
estimation is obtained from updating the prior estimate with the
information contained in the observation (using Bayes’ rule).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot2 theme</span></span>
<span><span class="va">mytheme</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text             <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="st">"Avenir Next Condensed"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    legend.text      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.text        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    strip.text       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.box       <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>    legend.position  <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    plot.title       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span>         <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="va">xprior</span>    <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">prior</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">xpost</span>     <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">xpost_sd</span>  <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">sd</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">X</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,y<span class="op">=</span><span class="va">xpost</span>,color<span class="op">=</span><span class="st">"State Estimates (Posterior)"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,y<span class="op">=</span><span class="va">xprior</span>,color<span class="op">=</span><span class="st">"State Estimates (Prior)"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,ymin<span class="op">=</span><span class="va">xpost</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span>,ymax<span class="op">=</span><span class="va">xpost</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"grey"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">t</span>,<span class="va">data</span><span class="op">$</span><span class="va">Y</span>,color<span class="op">=</span><span class="st">"Observations"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,linetype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">""</span>, color<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="sdeTMB_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="residual-analysis">Residual analysis<a class="anchor" aria-label="anchor" href="#residual-analysis"></a>
</h2>
<hr>
<p>We can display a standard residual analysis for the observations by
calling <code>plot</code> on the <code>fit</code> object, which invokes
the <code>S3</code> <code>plot.sdeTMB.fit</code> method of
<code>plot</code>. This includes a quantile-quantile plot, histogram,
auto-correlations and cumulative periodogram.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="sdeTMB_files/figure-html/unnamed-chunk-22-1.png" width="700">
The residuals (both standard and normalized) can be extracted as well,
together with their standard deviation and covariance matrix via
<code>fit$residuals</code></p>
</div>
<div class="section level2">
<h2 id="extra-adding-algebraic-equations">
<strong>Extra:</strong> Adding algebraic equations<a class="anchor" aria-label="anchor" href="#extra-adding-algebraic-equations"></a>
</h2>
<hr>
<p>For the sake of clarity it can sometimes be easier to specify simple
variables in the equations in place of some other (perhaps larger)
expression. We can redefine a variable name by providing an algebraic
relation.</p>
<p>Let’s say that we wish only to consider positive values of the
parameter <span class="math inline">\(\theta\)</span>, then it is
appropriate to estimate in the log-domain (since the domain of the
logarithm is the positive real axis). We use <span class="math inline">\(\theta = \exp\left(\log\theta\right)\)</span> and
introduce the parameter <code>logtheta</code> to replace
<code>theta</code>. This is obviously just names, and you might as well
have written <code>exp(theta)</code> directly when specifying the system
equations, but calling the parameter <code>logtheta</code> reminds one
that we are really interested in the exponential of the parameter.</p>
<p>We specify the algebraic relation like so:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_algebraics</span><span class="op">(</span><span class="va">theta</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logtheta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The parameter settings for <code>theta</code> are not automatically
transformed into <code>logtheta</code>, so they must be redefined:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">add_parameters</span><span class="op">(</span>logtheta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial<span class="op">=</span><span class="fl">5</span>, lower<span class="op">=</span><span class="fl">0</span>, upper<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Phillip Vetter.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
