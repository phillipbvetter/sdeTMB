<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sdeTMB">
<title>predict: Forecasting the model states and observations. • sdeTMB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="predict: Forecasting the model states and observations.">
<meta property="og:description" content="sdeTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sdeTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sdeTMB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/construct_nll.html">construct_nll: How to extract function handlers, and choosing your own optimizer</a>
    <a class="dropdown-item" href="../articles/estimate.html">estimate: Estimating model parameters and states</a>
    <a class="dropdown-item" href="../articles/observation_equations.html">observations: Using functions on the left-hand side</a>
    <a class="dropdown-item" href="../articles/predict.html">predict: Forecasting the model states and observations.</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phillipbvetter/sdeTMB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>predict: Forecasting the model states and observations.</h1>
                        <h4 data-toc-skip class="author"></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phillipbvetter/sdeTMB/blob/HEAD/vignettes/predict.Rmd" class="external-link"><code>vignettes/predict.Rmd</code></a></small>
      <div class="d-none name"><code>predict.Rmd</code></div>
    </div>

    
    
<p>We demonstate how to use the <code>predict</code> method to obtain
k-step ahead predictions / forecasts of a model object, and the
observations.</p>
<p>A prediction in this context is considered to be a prior estimate of
the state mean and covariance i.e. an estimate obtained without
incorporating information from future observations. We denote these</p>
<p><span class="math display">\[
\hat{x}_{i|j} = \mathrm{E}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}}) \\
\hat{P}_{i|j} = \mathrm{V}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}})
\]</span> where <span class="math inline">\(i \geq j\)</span>.</p>
<p>The <code>predict</code> method computes the predictions depending on
its argument <code>method</code> in the following way:</p>
<ol style="list-style-type: decimal">
<li><p>The Extended Kalman FIlter (<code>method=ekf</code>): The
posterior values <span class="math inline">\(\hat{x}_{i|i}\)</span>,
<span class="math inline">\(\hat{P}_{i|i}\)</span> are obtained from the
filter. In each iteration the moment ODEs <span class="math display">\[
\begin{align}
\frac{d\hat{x}_{i|i}}{dt} &amp;= f(\hat{x}_{i|i},\cdots) \\
\frac{d\hat{P}_{i|i}}{dt} &amp;=
\left[\frac{df}{dx}(\hat{x}_{i|i},\cdots)\right] \hat{P}_{i|i} +
\hat{P}_{i|i} \left[\frac{df}{dx}(\hat{x}_{i|i},\cdots)\right]^{T} +
G(\hat{x}_{i|i},\cdots)G^{T}(\hat{x}_{i|i},\cdots)
\end{align}
\]</span> are solved from the initial time <span class="math inline">\(t_{i}\)</span> until <span class="math inline">\(t_{j}\)</span> where the number of steps is
determined by the argument <code>k.ahead</code> to <code>predict</code>,
i.e. <code>j=i+k.ahead</code>. The solution at each time point <span class="math inline">\(t_{i+1}, t_{i+2}, \dots, t_{i+k.ahead}\)</span> is
the desired predictions. We note that these predictions assume that the
underlying probability density of the SDE remains approximately
Gaussian. If the prediction horizon is large then this assumption
probably doesn’t hold, and one should instead use stochastic predictions
via the argument <code>stochastic=TRUE</code>. The stochastic
predictions are generated by simulating the SDE forward in time many
times using an Euler-Maruyama scheme and reporting back quantiles of the
emperical distribution.</p></li>
<li><p>The Laplace Approximation (<code>method=tmb</code>): The
<code>predict</code> method is not yet implemented.</p></li>
</ol>
<div class="section level2">
<h2 id="simulate-from-the-ornstein-uhlenbeck-process">Simulate from the Ornstein-Uhlenbeck process<a class="anchor" aria-label="anchor" href="#simulate-from-the-ornstein-uhlenbeck-process"></a>
</h2>
<hr>
<p>We use the Ornstein-Uhlenbeck process again.</p>
<p><span class="math display">\[
\mathrm{d}X_{t} = \theta (\mu - X_{t}) \, \mathrm{d}t \, + \sigma_{X} \,
\mathrm{d}B_{t}
\]</span></p>
<p><span class="math display">\[
Y_{t_{k}} = X_{t_{k}} + e_{t_{k}}, \qquad e_{t_{k}} \sim
\mathcal{N}\left(0,\sigma_{Y}^{2}\right)  
\]</span> We first create data by simulating the process</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data using Euler Maruyama</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">theta</span><span class="op">=</span><span class="fl">10</span>; <span class="va">mu</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_x</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_y</span><span class="op">=</span><span class="fl">1e-1</span></span>
<span><span class="co"># </span></span>
<span><span class="va">dt.sim</span> <span class="op">=</span> <span class="fl">1e-3</span></span>
<span><span class="va">t.sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.sim</span><span class="op">)</span></span>
<span><span class="va">dw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt.sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">*</span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">dt.sim</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract observations and add noise</span></span>
<span><span class="va">dt.obs</span> <span class="op">=</span> <span class="fl">1e-2</span></span>
<span><span class="va">t.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.obs</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">t.sim</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">t.obs</span><span class="op">]</span> <span class="op">+</span> <span class="va">sigma_y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data</span></span>
<span><span class="va">.data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="va">t.obs</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-model-object">Construct model object<a class="anchor" aria-label="anchor" href="#construct-model-object"></a>
</h2>
<hr>
<p>We now construct the <code>sdeTMB</code> model object</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create model object</span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="va"><a href="../reference/sdeTMB.html">sdeTMB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set name of model (and the created .cpp file)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">set_modelname</span><span class="op">(</span><span class="st">"ornstein_uhlenbeck"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add system equations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_systems</span><span class="op">(</span></span>
<span>  <span class="va">dx</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add observation equations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set observation equation variances</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observation_variances</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">sigma_y</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify algebraic relations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_algebraics</span><span class="op">(</span></span>
<span>  <span class="va">theta</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logtheta</span><span class="op">)</span>,</span>
<span>  <span class="va">sigma_x</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logsigma_x</span><span class="op">)</span>,</span>
<span>  <span class="va">sigma_y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logsigma_y</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify parameter initial values and lower/upper bounds in estimation</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_parameters</span><span class="op">(</span></span>
<span>  logtheta   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">5</span>,    lower <span class="op">=</span> <span class="fl">0</span>,    upper <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mu         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    initial <span class="op">=</span> <span class="fl">0</span>,    lower <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,  upper <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  logsigma_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  logsigma_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial state mean and covariance</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">set_initial_state</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1e-1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predict">Predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h2>
<hr>
<p>We can use the predict function without having called
<code>estimate</code> first, in which case the initial value of the
parameters provided during <code>add_parameters</code> are used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code>predict</code> is a data.frame with indices and
time-points, state values and associated standard deviations, and
observations provided in the data, and predicted observation values
based from the predicted state values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $states</span></span>
<span><span class="co">##     i.  j.  t.i  t.j k.ahead         x        var.x</span></span>
<span><span class="co">## 1    0   0 0.00 0.00       0 3.0000000 0.1000000000</span></span>
<span><span class="co">## 2    0   1 0.00 0.01       1 2.8536883 0.0905789125</span></span>
<span><span class="co">## 3    1   1 0.01 0.01       0 2.7041164 0.0090057558</span></span>
<span><span class="co">## 4    1   2 0.01 0.02       1 2.5722351 0.0082439081</span></span>
<span><span class="co">## 5    2   2 0.02 0.02       0 2.6004105 0.0045187183</span></span>
<span><span class="co">## 6    2   3 0.02 0.03       1 2.4735870 0.0041838682</span></span>
<span><span class="co">## 7    3   3 0.03 0.03       0 2.4126775 0.0029497371</span></span>
<span><span class="co">## 8    3   4 0.03 0.04       1 2.2950098 0.0027641952</span></span>
<span><span class="co">## 9    4   4 0.04 0.04       0 2.2023814 0.0021655852</span></span>
<span><span class="co">## 10   4   5 0.04 0.05       1 2.0949700 0.0020546652</span></span>
<span><span class="co">## 11   5   5 0.05 0.05       0 2.0464391 0.0017044565</span></span>
<span><span class="co">## 12   5   6 0.05 0.06       1 1.9466331 0.0016374186</span></span>
<span><span class="co">## 13   6   6 0.06 0.06       0 1.9220889 0.0014070291</span></span>
<span><span class="co">## 14   6   7 0.06 0.07       1 1.8283475 0.0013682952</span></span>
<span><span class="co">## 15   7   7 0.07 0.07       0 1.8281541 0.0012036063</span></span>
<span><span class="co">## 16   7   8 0.07 0.08       1 1.7389940 0.0011842306</span></span>
<span><span class="co">## 17   8   8 0.08 0.08       0 1.7041538 0.0010588396</span></span>
<span><span class="co">## 18   8   9 0.08 0.09       1 1.6210412 0.0010532403</span></span>
<span><span class="co">## 19   9   9 0.09 0.09       0 1.6291405 0.0009528792</span></span>
<span><span class="co">## 20   9  10 0.09 0.10       1 1.5496864 0.0009573633</span></span>
<span><span class="co">## 21  10  10 0.10 0.10       0 1.5494076 0.0008737169</span></span>
<span><span class="co">## 22  10  11 0.10 0.11       1 1.4738421 0.0008857343</span></span>
<span><span class="co">## 23  11  11 0.11 0.11       0 1.4837636 0.0008136652</span></span>
<span><span class="co">## 24  11  12 0.11 0.12       1 1.4113996 0.0008313973</span></span>
<span><span class="co">## 25  12  12 0.12 0.12       0 1.4374217 0.0007675808</span></span>
<span><span class="co">## 26  12  13 0.12 0.13       1 1.3673178 0.0007896984</span></span>
<span><span class="co">## 27  13  13 0.13 0.13       0 1.3695955 0.0007319003</span></span>
<span><span class="co">## 28  13  14 0.13 0.14       1 1.3027995 0.0007574134</span></span>
<span><span class="co">## 29  14  14 0.14 0.14       0 1.3061822 0.0007040850</span></span>
<span><span class="co">## 30  14  15 0.14 0.15       1 1.2424790 0.0007322450</span></span>
<span><span class="co">## 31  15  15 0.15 0.15       0 1.2446653 0.0006822851</span></span>
<span><span class="co">## 32  15  16 0.15 0.16       1 1.1839623 0.0007125196</span></span>
<span><span class="co">## 33  16  16 0.16 0.16       0 1.1922016 0.0006651279</span></span>
<span><span class="co">## 34  16  17 0.16 0.17       1 1.1340572 0.0006969952</span></span>
<span><span class="co">## 35  17  17 0.17 0.17       0 1.1294292 0.0006515804</span></span>
<span><span class="co">## 36  17  18 0.17 0.18       1 1.0743463 0.0006847368</span></span>
<span><span class="co">## 37  18  18 0.18 0.18       0 1.0706612 0.0006408551</span></span>
<span><span class="co">## 38  18  19 0.18 0.19       1 1.0184444 0.0006750323</span></span>
<span><span class="co">## 39  19  19 0.19 0.19       0 1.0278052 0.0006323468</span></span>
<span><span class="co">## 40  19  20 0.19 0.20       1 0.9776785 0.0006673336</span></span>
<span><span class="co">## 41  20  20 0.20 0.20       0 0.9704597 0.0006255861</span></span>
<span><span class="co">## 42  20  21 0.20 0.21       1 0.9231298 0.0006612163</span></span>
<span><span class="co">## 43  21  21 0.21 0.21       0 0.9315183 0.0006202072</span></span>
<span><span class="co">## 44  21  22 0.21 0.22       1 0.8860876 0.0006563492</span></span>
<span><span class="co">## 45  22  22 0.22 0.22       0 0.8901063 0.0006159232</span></span>
<span><span class="co">## 46  22  23 0.22 0.23       1 0.8466953 0.0006524729</span></span>
<span><span class="co">## 47  23  23 0.23 0.23       0 0.8567910 0.0006125084</span></span>
<span><span class="co">## 48  23  24 0.23 0.24       1 0.8150048 0.0006493830</span></span>
<span><span class="co">## 49  24  24 0.24 0.24       0 0.8140256 0.0006097847</span></span>
<span><span class="co">## 50  24  25 0.24 0.25       1 0.7743251 0.0006469185</span></span>
<span><span class="co">## 51  25  25 0.25 0.25       0 0.7835132 0.0006076110</span></span>
<span><span class="co">## 52  25  26 0.25 0.26       1 0.7453008 0.0006449518</span></span>
<span><span class="co">## 53  26  26 0.26 0.26       0 0.7479445 0.0006058757</span></span>
<span><span class="co">## 54  26  27 0.26 0.27       1 0.7114668 0.0006433815</span></span>
<span><span class="co">## 55  27  27 0.27 0.27       0 0.7249522 0.0006044898</span></span>
<span><span class="co">## 56  27  28 0.27 0.28       1 0.6895959 0.0006421275</span></span>
<span><span class="co">## 57  28  28 0.28 0.28       0 0.7017095 0.0006033827</span></span>
<span><span class="co">## 58  28  29 0.28 0.29       1 0.6674867 0.0006411258</span></span>
<span><span class="co">## 59  29  29 0.29 0.29       0 0.6784737 0.0006024981</span></span>
<span><span class="co">## 60  29  30 0.29 0.30       1 0.6453841 0.0006403253</span></span>
<span><span class="co">## 61  30  30 0.30 0.30       0 0.6826068 0.0006017911</span></span>
<span><span class="co">## 62  30  31 0.30 0.31       1 0.6493156 0.0006396857</span></span>
<span><span class="co">## 63  31  31 0.31 0.31       0 0.6796551 0.0006012261</span></span>
<span><span class="co">## 64  31  32 0.31 0.32       1 0.6465080 0.0006391744</span></span>
<span><span class="co">## 65  32  32 0.32 0.32       0 0.6964303 0.0006007745</span></span>
<span><span class="co">## 66  32  33 0.32 0.33       1 0.6624650 0.0006387658</span></span>
<span><span class="co">## 67  33  33 0.33 0.33       0 0.6996848 0.0006004134</span></span>
<span><span class="co">## 68  33  34 0.33 0.34       1 0.6655608 0.0006384391</span></span>
<span><span class="co">## 69  34  34 0.34 0.34       0 0.6951424 0.0006001248</span></span>
<span><span class="co">## 70  34  35 0.34 0.35       1 0.6612399 0.0006381779</span></span>
<span><span class="co">## 71  35  35 0.35 0.35       0 0.6982807 0.0005998940</span></span>
<span><span class="co">## 72  35  36 0.35 0.36       1 0.6642252 0.0006379691</span></span>
<span><span class="co">## 73  36  36 0.36 0.36       0 0.7189928 0.0005997095</span></span>
<span><span class="co">## 74  36  37 0.36 0.37       1 0.6839271 0.0006378021</span></span>
<span><span class="co">## 75  37  37 0.37 0.37       0 0.7403732 0.0005995619</span></span>
<span><span class="co">## 76  37  38 0.37 0.38       1 0.7042648 0.0006376686</span></span>
<span><span class="co">## 77  38  38 0.38 0.38       0 0.7515000 0.0005994440</span></span>
<span><span class="co">## 78  38  39 0.38 0.39       1 0.7148489 0.0006375619</span></span>
<span><span class="co">## 79  39  39 0.39 0.39       0 0.7559364 0.0005993496</span></span>
<span><span class="co">## 80  39  40 0.39 0.40       1 0.7190689 0.0006374765</span></span>
<span><span class="co">## 81  40  40 0.40 0.40       0 0.7666375 0.0005992742</span></span>
<span><span class="co">## 82  40  41 0.40 0.41       1 0.7292482 0.0006374083</span></span>
<span><span class="co">## 83  41  41 0.41 0.41       0 0.7667833 0.0005992139</span></span>
<span><span class="co">## 84  41  42 0.41 0.42       1 0.7293868 0.0006373537</span></span>
<span><span class="co">## 85  42  42 0.42 0.42       0 0.7561428 0.0005991656</span></span>
<span><span class="co">## 86  42  43 0.42 0.43       1 0.7192653 0.0006373100</span></span>
<span><span class="co">## 87  43  43 0.43 0.43       0 0.7493877 0.0005991271</span></span>
<span><span class="co">## 88  43  44 0.43 0.44       1 0.7128396 0.0006372751</span></span>
<span><span class="co">## 89  44  44 0.44 0.44       0 0.7534882 0.0005990962</span></span>
<span><span class="co">## 90  44  45 0.44 0.45       1 0.7167401 0.0006372472</span></span>
<span><span class="co">## 91  45  45 0.45 0.45       0 0.7514280 0.0005990716</span></span>
<span><span class="co">## 92  45  46 0.45 0.46       1 0.7147804 0.0006372249</span></span>
<span><span class="co">## 93  46  46 0.46 0.46       0 0.7372187 0.0005990518</span></span>
<span><span class="co">## 94  46  47 0.46 0.47       1 0.7012642 0.0006372071</span></span>
<span><span class="co">## 95  47  47 0.47 0.47       0 0.7323972 0.0005990361</span></span>
<span><span class="co">## 96  47  48 0.47 0.48       1 0.6966778 0.0006371928</span></span>
<span><span class="co">## 97  48  48 0.48 0.48       0 0.7285917 0.0005990235</span></span>
<span><span class="co">## 98  48  49 0.48 0.49       1 0.6930578 0.0006371814</span></span>
<span><span class="co">## 99  49  49 0.49 0.49       0 0.7115398 0.0005990134</span></span>
<span><span class="co">## 100 49  50 0.49 0.50       1 0.6768376 0.0006371723</span></span>
<span><span class="co">## 101 50  50 0.50 0.50       0 0.7017129 0.0005990053</span></span>
<span><span class="co">## 102 50  51 0.50 0.51       1 0.6674899 0.0006371650</span></span>
<span><span class="co">## 103 51  51 0.51 0.51       0 0.6985287 0.0005989989</span></span>
<span><span class="co">## 104 51  52 0.51 0.52       1 0.6644611 0.0006371591</span></span>
<span><span class="co">## 105 52  52 0.52 0.52       0 0.6888187 0.0005989937</span></span>
<span><span class="co">## 106 52  53 0.52 0.53       1 0.6552246 0.0006371545</span></span>
<span><span class="co">## 107 53  53 0.53 0.53       0 0.6817039 0.0005989896</span></span>
<span><span class="co">## 108 53  54 0.53 0.54       1 0.6484569 0.0006371507</span></span>
<span><span class="co">## 109 54  54 0.54 0.54       0 0.6675931 0.0005989863</span></span>
<span><span class="co">## 110 54  55 0.54 0.55       1 0.6350342 0.0006371477</span></span>
<span><span class="co">## 111 55  55 0.55 0.55       0 0.6484261 0.0005989836</span></span>
<span><span class="co">## 112 55  56 0.55 0.56       1 0.6168020 0.0006371454</span></span>
<span><span class="co">## 113 56  56 0.56 0.56       0 0.6258193 0.0005989815</span></span>
<span><span class="co">## 114 56  57 0.56 0.57       1 0.5952978 0.0006371434</span></span>
<span><span class="co">## 115 57  57 0.57 0.57       0 0.6230721 0.0005989798</span></span>
<span><span class="co">## 116 57  58 0.57 0.58       1 0.5926845 0.0006371419</span></span>
<span><span class="co">## 117 58  58 0.58 0.58       0 0.6346486 0.0005989785</span></span>
<span><span class="co">## 118 58  59 0.58 0.59       1 0.6036964 0.0006371407</span></span>
<span><span class="co">## 119 59  59 0.59 0.59       0 0.6185911 0.0005989774</span></span>
<span><span class="co">## 120 59  60 0.59 0.60       1 0.5884220 0.0006371397</span></span>
<span><span class="co">## 121 60  60 0.60 0.60       0 0.6184279 0.0005989765</span></span>
<span><span class="co">## 122 60  61 0.60 0.61       1 0.5882668 0.0006371389</span></span>
<span><span class="co">## 123 61  61 0.61 0.61       0 0.6261620 0.0005989759</span></span>
<span><span class="co">## 124 61  62 0.61 0.62       1 0.5956237 0.0006371383</span></span>
<span><span class="co">## 125 62  62 0.62 0.62       0 0.6192352 0.0005989753</span></span>
<span><span class="co">## 126 62  63 0.62 0.63       1 0.5890347 0.0006371378</span></span>
<span><span class="co">## 127 63  63 0.63 0.63       0 0.6107497 0.0005989749</span></span>
<span><span class="co">## 128 63  64 0.63 0.64       1 0.5809631 0.0006371374</span></span>
<span><span class="co">## 129 64  64 0.64 0.64       0 0.6002009 0.0005989745</span></span>
<span><span class="co">## 130 64  65 0.64 0.65       1 0.5709288 0.0006371371</span></span>
<span><span class="co">## 131 65  65 0.65 0.65       0 0.5907953 0.0005989742</span></span>
<span><span class="co">## 132 65  66 0.65 0.66       1 0.5619819 0.0006371368</span></span>
<span><span class="co">## 133 66  66 0.66 0.66       0 0.5981402 0.0005989740</span></span>
<span><span class="co">## 134 66  67 0.66 0.67       1 0.5689685 0.0006371366</span></span>
<span><span class="co">## 135 67  67 0.67 0.67       0 0.6026078 0.0005989738</span></span>
<span><span class="co">## 136 67  68 0.67 0.68       1 0.5732183 0.0006371365</span></span>
<span><span class="co">## 137 68  68 0.68 0.68       0 0.6142482 0.0005989737</span></span>
<span><span class="co">## 138 68  69 0.68 0.69       1 0.5842910 0.0006371363</span></span>
<span><span class="co">## 139 69  69 0.69 0.69       0 0.6101996 0.0005989736</span></span>
<span><span class="co">## 140 69  70 0.69 0.70       1 0.5804398 0.0006371362</span></span>
<span><span class="co">## 141 70  70 0.70 0.70       0 0.5998545 0.0005989735</span></span>
<span><span class="co">## 142 70  71 0.70 0.71       1 0.5705993 0.0006371362</span></span>
<span><span class="co">## 143 71  71 0.71 0.71       0 0.5962865 0.0005989734</span></span>
<span><span class="co">## 144 71  72 0.71 0.72       1 0.5672053 0.0006371361</span></span>
<span><span class="co">## 145 72  72 0.72 0.72       0 0.5742607 0.0005989733</span></span>
<span><span class="co">## 146 72  73 0.72 0.73       1 0.5462537 0.0006371360</span></span>
<span><span class="co">## 147 73  73 0.73 0.73       0 0.5520129 0.0005989733</span></span>
<span><span class="co">## 148 73  74 0.73 0.74       1 0.5250909 0.0006371360</span></span>
<span><span class="co">## 149 74  74 0.74 0.74       0 0.5222961 0.0005989733</span></span>
<span><span class="co">## 150 74  75 0.74 0.75       1 0.4968234 0.0006371360</span></span>
<span><span class="co">## 151 75  75 0.75 0.75       0 0.5135329 0.0005989732</span></span>
<span><span class="co">## 152 75  76 0.75 0.76       1 0.4884876 0.0006371359</span></span>
<span><span class="co">## 153 76  76 0.76 0.76       0 0.4918789 0.0005989732</span></span>
<span><span class="co">## 154 76  77 0.76 0.77       1 0.4678897 0.0006371359</span></span>
<span><span class="co">## 155 77  77 0.77 0.77       0 0.4970710 0.0005989732</span></span>
<span><span class="co">## 156 77  78 0.77 0.78       1 0.4728286 0.0006371359</span></span>
<span><span class="co">## 157 78  78 0.78 0.78       0 0.5001839 0.0005989732</span></span>
<span><span class="co">## 158 78  79 0.78 0.79       1 0.4757897 0.0006371359</span></span>
<span><span class="co">## 159 79  79 0.79 0.79       0 0.4952266 0.0005989732</span></span>
<span><span class="co">## 160 79  80 0.79 0.80       1 0.4710741 0.0006371359</span></span>
<span><span class="co">## 161 80  80 0.80 0.80       0 0.4898556 0.0005989731</span></span>
<span><span class="co">## 162 80  81 0.80 0.81       1 0.4659650 0.0006371359</span></span>
<span><span class="co">## 163 81  81 0.81 0.81       0 0.4883110 0.0005989731</span></span>
<span><span class="co">## 164 81  82 0.81 0.82       1 0.4644958 0.0006371359</span></span>
<span><span class="co">## 165 82  82 0.82 0.82       0 0.4998259 0.0005989731</span></span>
<span><span class="co">## 166 82  83 0.82 0.83       1 0.4754491 0.0006371358</span></span>
<span><span class="co">## 167 83  83 0.83 0.83       0 0.5009212 0.0005989731</span></span>
<span><span class="co">## 168 83  84 0.83 0.84       1 0.4764909 0.0006371358</span></span>
<span><span class="co">## 169 84  84 0.84 0.84       0 0.4840698 0.0005989731</span></span>
<span><span class="co">## 170 84  85 0.84 0.85       1 0.4604615 0.0006371358</span></span>
<span><span class="co">## 171 85  85 0.85 0.85       0 0.4836321 0.0005989731</span></span>
<span><span class="co">## 172 85  86 0.85 0.86       1 0.4600451 0.0006371358</span></span>
<span><span class="co">## 173 86  86 0.86 0.86       0 0.4708446 0.0005989731</span></span>
<span><span class="co">## 174 86  87 0.86 0.87       1 0.4478812 0.0006371358</span></span>
<span><span class="co">## 175 87  87 0.87 0.87       0 0.4690601 0.0005989731</span></span>
<span><span class="co">## 176 87  88 0.87 0.88       1 0.4461838 0.0006371358</span></span>
<span><span class="co">## 177 88  88 0.88 0.88       0 0.4655931 0.0005989731</span></span>
<span><span class="co">## 178 88  89 0.88 0.89       1 0.4428859 0.0006371358</span></span>
<span><span class="co">## 179 89  89 0.89 0.89       0 0.4795782 0.0005989731</span></span>
<span><span class="co">## 180 89  90 0.89 0.90       1 0.4561889 0.0006371358</span></span>
<span><span class="co">## 181 90  90 0.90 0.90       0 0.4962998 0.0005989731</span></span>
<span><span class="co">## 182 90  91 0.90 0.91       1 0.4720950 0.0006371358</span></span>
<span><span class="co">## 183 91  91 0.91 0.91       0 0.5143556 0.0005989731</span></span>
<span><span class="co">## 184 91  92 0.91 0.92       1 0.4892701 0.0006371358</span></span>
<span><span class="co">## 185 92  92 0.92 0.92       0 0.5279663 0.0005989731</span></span>
<span><span class="co">## 186 92  93 0.92 0.93       1 0.5022171 0.0006371358</span></span>
<span><span class="co">## 187 93  93 0.93 0.93       0 0.5562919 0.0005989731</span></span>
<span><span class="co">## 188 93  94 0.93 0.94       1 0.5291612 0.0006371358</span></span>
<span><span class="co">## 189 94  94 0.94 0.94       0 0.5800575 0.0005989731</span></span>
<span><span class="co">## 190 94  95 0.94 0.95       1 0.5517677 0.0006371358</span></span>
<span><span class="co">## 191 95  95 0.95 0.95       0 0.5961139 0.0005989731</span></span>
<span><span class="co">## 192 95  96 0.95 0.96       1 0.5670411 0.0006371358</span></span>
<span><span class="co">## 193 96  96 0.96 0.96       0 0.6175555 0.0005989731</span></span>
<span><span class="co">## 194 96  97 0.96 0.97       1 0.5874370 0.0006371358</span></span>
<span><span class="co">## 195 97  97 0.97 0.97       0 0.6473161 0.0005989731</span></span>
<span><span class="co">## 196 97  98 0.97 0.98       1 0.6157461 0.0006371358</span></span>
<span><span class="co">## 197 98  98 0.98 0.98       0 0.6654603 0.0005989731</span></span>
<span><span class="co">## 198 98  99 0.98 0.99       1 0.6330054 0.0006371358</span></span>
<span><span class="co">## 199 99  99 0.99 0.99       0 0.6715236 0.0005989731</span></span>
<span><span class="co">## 200 99 100 0.99 1.00       1 0.6387730 0.0006371358</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $observations</span></span>
<span><span class="co">##       i.  j.  t.i  t.j k.ahead y.predict    y.data</span></span>
<span><span class="co">## 1      0   0 0.00 0.00       0 3.0000000 3.1050014</span></span>
<span><span class="co">## 2      0   1 0.00 0.01       1 2.8536883 2.6876035</span></span>
<span><span class="co">## 2.1    1   1 0.01 0.01       0 2.7041164 2.6876035</span></span>
<span><span class="co">## 3      1   2 0.01 0.02       1 2.5722351 2.6345878</span></span>
<span><span class="co">## 3.1    2   2 0.02 0.02       0 2.6004105 2.6345878</span></span>
<span><span class="co">## 4      2   3 0.02 0.03       1 2.4735870 2.2670956</span></span>
<span><span class="co">## 4.1    3   3 0.03 0.03       0 2.4126775 2.2670956</span></span>
<span><span class="co">## 5      3   4 0.03 0.04       1 2.2950098 1.8672805</span></span>
<span><span class="co">## 5.1    4   4 0.04 0.04       0 2.2023814 1.8672805</span></span>
<span><span class="co">## 6      4   5 0.04 0.05       1 2.0949700 1.8102407</span></span>
<span><span class="co">## 6.1    5   5 0.05 0.05       0 2.0464391 1.8102407</span></span>
<span><span class="co">## 7      5   6 0.05 0.06       1 1.9466331 1.7721929</span></span>
<span><span class="co">## 7.1    6   6 0.06 0.06       0 1.9220889 1.7721929</span></span>
<span><span class="co">## 8      6   7 0.06 0.07       1 1.8283475 1.8267411</span></span>
<span><span class="co">## 8.1    7   7 0.07 0.07       0 1.8281541 1.8267411</span></span>
<span><span class="co">## 9      7   8 0.07 0.08       1 1.7389940 1.4099524</span></span>
<span><span class="co">## 9.1    8   8 0.08 0.08       0 1.7041538 1.4099524</span></span>
<span><span class="co">## 10     8   9 0.08 0.09       1 1.6210412 1.7060396</span></span>
<span><span class="co">## 10.1   9   9 0.09 0.09       0 1.6291405 1.7060396</span></span>
<span><span class="co">## 11     9  10 0.09 0.10       1 1.5496864 1.5464949</span></span>
<span><span class="co">## 11.1  10  10 0.10 0.10       0 1.5494076 1.5464949</span></span>
<span><span class="co">## 12    10  11 0.10 0.11       1 1.4738421 1.5957778</span></span>
<span><span class="co">## 12.1  11  11 0.11 0.11       0 1.4837636 1.5957778</span></span>
<span><span class="co">## 13    11  12 0.11 0.12       1 1.4113996 1.7504143</span></span>
<span><span class="co">## 13.1  12  12 0.12 0.12       0 1.4374217 1.7504143</span></span>
<span><span class="co">## 14    12  13 0.12 0.13       1 1.3673178 1.3984381</span></span>
<span><span class="co">## 14.1  13  13 0.13 0.13       0 1.3695955 1.3984381</span></span>
<span><span class="co">## 15    13  14 0.13 0.14       1 1.3027995 1.3508432</span></span>
<span><span class="co">## 15.1  14  14 0.14 0.14       0 1.3061822 1.3508432</span></span>
<span><span class="co">## 16    14  15 0.14 0.15       1 1.2424790 1.2745233</span></span>
<span><span class="co">## 16.1  15  15 0.15 0.15       0 1.2446653 1.2745233</span></span>
<span><span class="co">## 17    15  16 0.15 0.16       1 1.1839623 1.3078374</span></span>
<span><span class="co">## 17.1  16  16 0.16 0.16       0 1.1922016 1.3078374</span></span>
<span><span class="co">## 18    16  17 0.16 0.17       1 1.1340572 1.0630302</span></span>
<span><span class="co">## 18.1  17  17 0.17 0.17       0 1.1294292 1.0630302</span></span>
<span><span class="co">## 19    17  18 0.17 0.18       1 1.0743463 1.0168427</span></span>
<span><span class="co">## 19.1  18  18 0.18 0.18       0 1.0706612 1.0168427</span></span>
<span><span class="co">## 20    18  19 0.18 0.19       1 1.0184444 1.1664768</span></span>
<span><span class="co">## 20.1  19  19 0.19 0.19       0 1.0278052 1.1664768</span></span>
<span><span class="co">## 21    19  20 0.19 0.20       1 0.9776785 0.8622847</span></span>
<span><span class="co">## 21.1  20  20 0.20 0.20       0 0.9704597 0.8622847</span></span>
<span><span class="co">## 22    20  21 0.20 0.21       1 0.9231298 1.0583837</span></span>
<span><span class="co">## 22.1  21  21 0.21 0.21       0 0.9315183 1.0583837</span></span>
<span><span class="co">## 23    21  22 0.21 0.22       1 0.8860876 0.9513334</span></span>
<span><span class="co">## 23.1  22  22 0.22 0.22       0 0.8901063 0.9513334</span></span>
<span><span class="co">## 24    22  23 0.22 0.23       1 0.8466953 1.0115208</span></span>
<span><span class="co">## 24.1  23  23 0.23 0.23       0 0.8567910 1.0115208</span></span>
<span><span class="co">## 25    23  24 0.23 0.24       1 0.8150048 0.7989467</span></span>
<span><span class="co">## 25.1  24  24 0.24 0.24       0 0.8140256 0.7989467</span></span>
<span><span class="co">## 26    24  25 0.24 0.25       1 0.7743251 0.9255422</span></span>
<span><span class="co">## 26.1  25  25 0.25 0.25       0 0.7835132 0.9255422</span></span>
<span><span class="co">## 27    25  26 0.25 0.26       1 0.7453008 0.7889344</span></span>
<span><span class="co">## 27.1  26  26 0.26 0.26       0 0.7479445 0.7889344</span></span>
<span><span class="co">## 28    26  27 0.26 0.27       1 0.7114668 0.9345539</span></span>
<span><span class="co">## 28.1  27  27 0.27 0.27       0 0.7249522 0.9345539</span></span>
<span><span class="co">## 29    27  28 0.27 0.28       1 0.6895959 0.8903579</span></span>
<span><span class="co">## 29.1  28  28 0.28 0.28       0 0.7017095 0.8903579</span></span>
<span><span class="co">## 30    28  29 0.28 0.29       1 0.6674867 0.8498436</span></span>
<span><span class="co">## 30.1  29  29 0.29 0.29       0 0.6784737 0.8498436</span></span>
<span><span class="co">## 31    29  30 0.29 0.30       1 0.6453841 1.2639148</span></span>
<span><span class="co">## 31.1  30  30 0.30 0.30       0 0.6826068 1.2639148</span></span>
<span><span class="co">## 32    30  31 0.30 0.31       1 0.6493156 1.1539427</span></span>
<span><span class="co">## 32.1  31  31 0.31 0.31       0 0.6796551 1.1539427</span></span>
<span><span class="co">## 33    31  32 0.31 0.32       1 0.6465080 1.4774740</span></span>
<span><span class="co">## 33.1  32  32 0.32 0.32       0 0.6964303 1.4774740</span></span>
<span><span class="co">## 34    32  33 0.32 0.33       1 0.6624650 1.2823684</span></span>
<span><span class="co">## 34.1  33  33 0.33 0.33       0 0.6996848 1.2823684</span></span>
<span><span class="co">## 35    33  34 0.33 0.34       1 0.6655608 1.1584845</span></span>
<span><span class="co">## 35.1  34  34 0.34 0.34       0 0.6951424 1.1584845</span></span>
<span><span class="co">## 36    34  35 0.34 0.35       1 0.6612399 1.2786969</span></span>
<span><span class="co">## 36.1  35  35 0.35 0.35       0 0.6982807 1.2786969</span></span>
<span><span class="co">## 37    35  36 0.35 0.36       1 0.6642252 1.5774615</span></span>
<span><span class="co">## 37.1  36  36 0.36 0.36       0 0.7189928 1.5774615</span></span>
<span><span class="co">## 38    36  37 0.36 0.37       1 0.6839271 1.6253826</span></span>
<span><span class="co">## 38.1  37  37 0.37 0.37       0 0.7403732 1.6253826</span></span>
<span><span class="co">## 39    37  38 0.37 0.38       1 0.7042648 1.4922488</span></span>
<span><span class="co">## 39.1  38  38 0.38 0.38       0 0.7515000 1.4922488</span></span>
<span><span class="co">## 40    38  39 0.38 0.39       1 0.7148489 1.4003827</span></span>
<span><span class="co">## 40.1  39  39 0.39 0.39       0 0.7559364 1.4003827</span></span>
<span><span class="co">## 41    39  40 0.39 0.40       1 0.7190689 1.5128390</span></span>
<span><span class="co">## 41.1  40  40 0.40 0.40       0 0.7666375 1.5128390</span></span>
<span><span class="co">## 42    40  41 0.40 0.41       1 0.7292482 1.3556542</span></span>
<span><span class="co">## 42.1  41  41 0.41 0.41       0 0.7667833 1.3556542</span></span>
<span><span class="co">## 43    41  42 0.41 0.42       1 0.7293868 1.1759413</span></span>
<span><span class="co">## 43.1  42  42 0.42 0.42       0 0.7561428 1.1759413</span></span>
<span><span class="co">## 44    42  43 0.42 0.43       1 0.7192653 1.2220367</span></span>
<span><span class="co">## 44.1  43  43 0.43 0.43       0 0.7493877 1.2220367</span></span>
<span><span class="co">## 45    43  44 0.43 0.44       1 0.7128396 1.3913373</span></span>
<span><span class="co">## 45.1  44  44 0.44 0.44       0 0.7534882 1.3913373</span></span>
<span><span class="co">## 46    44  45 0.44 0.45       1 0.7167401 1.2957664</span></span>
<span><span class="co">## 46.1  45  45 0.45 0.45       0 0.7514280 1.2957664</span></span>
<span><span class="co">## 47    45  46 0.45 0.46       1 0.7147804 1.0893450</span></span>
<span><span class="co">## 47.1  46  46 0.46 0.46       0 0.7372187 1.0893450</span></span>
<span><span class="co">## 48    46  47 0.46 0.47       1 0.7012642 1.2209833</span></span>
<span><span class="co">## 48.1  47  47 0.47 0.47       0 0.7323972 1.2209833</span></span>
<span><span class="co">## 49    47  48 0.47 0.48       1 0.6966778 1.2294432</span></span>
<span><span class="co">## 49.1  48  48 0.48 0.48       0 0.7285917 1.2294432</span></span>
<span><span class="co">## 50    48  49 0.48 0.49       1 0.6930578 1.0015985</span></span>
<span><span class="co">## 50.1  49  49 0.49 0.49       0 0.7115398 1.0015985</span></span>
<span><span class="co">## 51    49  50 0.49 0.50       1 0.6768376 1.0921132</span></span>
<span><span class="co">## 51.1  50  50 0.50 0.50       0 0.7017129 1.0921132</span></span>
<span><span class="co">## 52    50  51 0.50 0.51       1 0.6674899 1.1856681</span></span>
<span><span class="co">## 52.1  51  51 0.51 0.51       0 0.6985287 1.1856681</span></span>
<span><span class="co">## 53    51  52 0.51 0.52       1 0.6644611 1.0711030</span></span>
<span><span class="co">## 53.1  52  52 0.52 0.52       0 0.6888187 1.0711030</span></span>
<span><span class="co">## 54    52  53 0.52 0.53       1 0.6552246 1.0972914</span></span>
<span><span class="co">## 54.1  53  53 0.53 0.53       0 0.6817039 1.0972914</span></span>
<span><span class="co">## 55    53  54 0.53 0.54       1 0.6484569 0.9679338</span></span>
<span><span class="co">## 55.1  54  54 0.54 0.54       0 0.6675931 0.9679338</span></span>
<span><span class="co">## 56    54  55 0.54 0.55       1 0.6350342 0.8586111</span></span>
<span><span class="co">## 56.1  55  55 0.55 0.55       0 0.6484261 0.8586111</span></span>
<span><span class="co">## 57    55  56 0.55 0.56       1 0.6168020 0.7673472</span></span>
<span><span class="co">## 57.1  56  56 0.56 0.56       0 0.6258193 0.7673472</span></span>
<span><span class="co">## 58    56  57 0.56 0.57       1 0.5952978 1.0589918</span></span>
<span><span class="co">## 58.1  57  57 0.57 0.57       0 0.6230721 1.0589918</span></span>
<span><span class="co">## 59    57  58 0.57 0.58       1 0.5926845 1.2932782</span></span>
<span><span class="co">## 59.1  58  58 0.58 0.58       0 0.6346486 1.2932782</span></span>
<span><span class="co">## 60    58  59 0.58 0.59       1 0.6036964 0.8523648</span></span>
<span><span class="co">## 60.1  59  59 0.59 0.59       0 0.6185911 0.8523648</span></span>
<span><span class="co">## 61    59  60 0.59 0.60       1 0.5884220 1.0893742</span></span>
<span><span class="co">## 61.1  60  60 0.60 0.60       0 0.6184279 1.0893742</span></span>
<span><span class="co">## 62    60  61 0.60 0.61       1 0.5882668 1.2209327</span></span>
<span><span class="co">## 62.1  61  61 0.61 0.61       0 0.6261620 1.2209327</span></span>
<span><span class="co">## 63    61  62 0.61 0.62       1 0.5956237 0.9898213</span></span>
<span><span class="co">## 63.1  62  62 0.62 0.62       0 0.6192352 0.9898213</span></span>
<span><span class="co">## 64    62  63 0.62 0.63       1 0.5890347 0.9515711</span></span>
<span><span class="co">## 64.1  63  63 0.63 0.63       0 0.6107497 0.9515711</span></span>
<span><span class="co">## 65    63  64 0.63 0.64       1 0.5809631 0.9021424</span></span>
<span><span class="co">## 65.1  64  64 0.64 0.64       0 0.6002009 0.9021424</span></span>
<span><span class="co">## 66    64  65 0.64 0.65       1 0.5709288 0.9026052</span></span>
<span><span class="co">## 66.1  65  65 0.65 0.65       0 0.5907953 0.9026052</span></span>
<span><span class="co">## 67    65  66 0.65 0.66       1 0.5619819 1.1656516</span></span>
<span><span class="co">## 67.1  66  66 0.66 0.66       0 0.5981402 1.1656516</span></span>
<span><span class="co">## 68    66  67 0.66 0.67       1 0.5689685 1.1305835</span></span>
<span><span class="co">## 68.1  67  67 0.67 0.67       0 0.6026078 1.1305835</span></span>
<span><span class="co">## 69    67  68 0.67 0.68       1 0.5732183 1.2582223</span></span>
<span><span class="co">## 69.1  68  68 0.68 0.68       0 0.6142482 1.2582223</span></span>
<span><span class="co">## 70    68  69 0.68 0.69       1 0.5842910 1.0168412</span></span>
<span><span class="co">## 70.1  69  69 0.69 0.69       0 0.6101996 1.0168412</span></span>
<span><span class="co">## 71    69  70 0.69 0.70       1 0.5804398 0.9045731</span></span>
<span><span class="co">## 71.1  70  70 0.70 0.70       0 0.5998545 0.9045731</span></span>
<span><span class="co">## 72    70  71 0.70 0.71       1 0.5705993 0.9994536</span></span>
<span><span class="co">## 72.1  71  71 0.71 0.71       0 0.5962865 0.9994536</span></span>
<span><span class="co">## 73    71  72 0.71 0.72       1 0.5672053 0.6849976</span></span>
<span><span class="co">## 73.1  72  72 0.72 0.72       0 0.5742607 0.6849976</span></span>
<span><span class="co">## 74    72  73 0.72 0.73       1 0.5462537 0.6424049</span></span>
<span><span class="co">## 74.1  73  73 0.73 0.73       0 0.5520129 0.6424049</span></span>
<span><span class="co">## 75    73  74 0.73 0.74       1 0.5250909 0.4784305</span></span>
<span><span class="co">## 75.1  74  74 0.74 0.74       0 0.5222961 0.4784305</span></span>
<span><span class="co">## 76    74  75 0.74 0.75       1 0.4968234 0.7757928</span></span>
<span><span class="co">## 76.1  75  75 0.75 0.75       0 0.5135329 0.7757928</span></span>
<span><span class="co">## 77    75  76 0.75 0.76       1 0.4884876 0.5451065</span></span>
<span><span class="co">## 77.1  76  76 0.76 0.76       0 0.4918789 0.5451065</span></span>
<span><span class="co">## 78    76  77 0.76 0.77       1 0.4678897 0.9550785</span></span>
<span><span class="co">## 78.1  77  77 0.77 0.77       0 0.4970710 0.9550785</span></span>
<span><span class="co">## 79    77  78 0.77 0.78       1 0.4728286 0.9295327</span></span>
<span><span class="co">## 79.1  78  78 0.78 0.78       0 0.5001839 0.9295327</span></span>
<span><span class="co">## 80    78  79 0.78 0.79       1 0.4757897 0.8002935</span></span>
<span><span class="co">## 80.1  79  79 0.79 0.79       0 0.4952266 0.8002935</span></span>
<span><span class="co">## 81    79  80 0.79 0.80       1 0.4710741 0.7846353</span></span>
<span><span class="co">## 81.1  80  80 0.80 0.80       0 0.4898556 0.7846353</span></span>
<span><span class="co">## 82    80  81 0.80 0.81       1 0.4659650 0.8390361</span></span>
<span><span class="co">## 82.1  81  81 0.81 0.81       0 0.4883110 0.8390361</span></span>
<span><span class="co">## 83    81  82 0.81 0.82       1 0.4644958 1.0543397</span></span>
<span><span class="co">## 83.1  82  82 0.82 0.82       0 0.4998259 1.0543397</span></span>
<span><span class="co">## 84    82  83 0.82 0.83       1 0.4754491 0.9007118</span></span>
<span><span class="co">## 84.1  83  83 0.83 0.83       0 0.5009212 0.9007118</span></span>
<span><span class="co">## 85    83  84 0.83 0.84       1 0.4764909 0.6030225</span></span>
<span><span class="co">## 85.1  84  84 0.84 0.84       0 0.4840698 0.6030225</span></span>
<span><span class="co">## 86    84  85 0.84 0.85       1 0.4604615 0.8472999</span></span>
<span><span class="co">## 86.1  85  85 0.85 0.85       0 0.4836321 0.8472999</span></span>
<span><span class="co">## 87    85  86 0.85 0.86       1 0.4600451 0.6403460</span></span>
<span><span class="co">## 87.1  86  86 0.86 0.86       0 0.4708446 0.6403460</span></span>
<span><span class="co">## 88    86  87 0.86 0.87       1 0.4478812 0.8014683</span></span>
<span><span class="co">## 88.1  87  87 0.87 0.87       0 0.4690601 0.8014683</span></span>
<span><span class="co">## 89    87  88 0.87 0.88       1 0.4461838 0.7702269</span></span>
<span><span class="co">## 89.1  88  88 0.88 0.88       0 0.4655931 0.7702269</span></span>
<span><span class="co">## 90    88  89 0.88 0.89       1 0.4428859 1.0554731</span></span>
<span><span class="co">## 90.1  89  89 0.89 0.89       0 0.4795782 1.0554731</span></span>
<span><span class="co">## 91    89  90 0.89 0.90       1 0.4561889 1.1258505</span></span>
<span><span class="co">## 91.1  90  90 0.90 0.90       0 0.4962998 1.1258505</span></span>
<span><span class="co">## 92    90  91 0.90 0.91       1 0.4720950 1.1776452</span></span>
<span><span class="co">## 92.1  91  91 0.91 0.91       0 0.5143556 1.1776452</span></span>
<span><span class="co">## 93    91  92 0.91 0.92       1 0.4892701 1.1353116</span></span>
<span><span class="co">## 93.1  92  92 0.92 0.92       0 0.5279663 1.1353116</span></span>
<span><span class="co">## 94    92  93 0.92 0.93       1 0.5022171 1.4050089</span></span>
<span><span class="co">## 94.1  93  93 0.93 0.93       0 0.5562919 1.4050089</span></span>
<span><span class="co">## 95    93  94 0.93 0.94       1 0.5291612 1.3788863</span></span>
<span><span class="co">## 95.1  94  94 0.94 0.94       0 0.5800575 1.3788863</span></span>
<span><span class="co">## 96    94  95 0.94 0.95       1 0.5517677 1.2921382</span></span>
<span><span class="co">## 96.1  95  95 0.95 0.95       0 0.5961139 1.2921382</span></span>
<span><span class="co">## 97    95  96 0.95 0.96       1 0.5670411 1.4103918</span></span>
<span><span class="co">## 97.1  96  96 0.96 0.96       0 0.6175555 1.4103918</span></span>
<span><span class="co">## 98    96  97 0.96 0.97       1 0.5874370 1.5871333</span></span>
<span><span class="co">## 98.1  97  97 0.97 0.97       0 0.6473161 1.5871333</span></span>
<span><span class="co">## 99    97  98 0.97 0.98       1 0.6157461 1.4457355</span></span>
<span><span class="co">## 99.1  98  98 0.98 0.98       0 0.6654603 1.4457355</span></span>
<span><span class="co">## 100   98  99 0.98 0.99       1 0.6330054 1.2760765</span></span>
<span><span class="co">## 100.1 99  99 0.99 0.99       0 0.6715236 1.2760765</span></span>
<span><span class="co">## 101   99 100 0.99 1.00       1 0.6387730 1.2007236</span></span></code></pre>
<p>The indices <code>i</code> and <code>j</code> in the table refer to
expectation and variance of the state vector <span class="math display">\[
\mathrm{E}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}}) \\
\mathrm{V}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}})
\]</span> where the moments are given at indices <span class="math inline">\(i\)</span> (time <span class="math inline">\(t_{i}\)</span>) conditioned on the information
available up until indices <span class="math inline">\(j\)</span> (time
<span class="math inline">\(t_{j}\)</span>). In this sense the
state/covariance predictions with <span class="math inline">\(i=j\)</span> are posterior estimates, and all
others are prior estimates.</p>
<p>By default only the standard deviations of the states are returned.
The entire covariance matrix elements can be returned via</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, return.covariance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-number-of-prediction-steps">Set number of prediction steps<a class="anchor" aria-label="anchor" href="#set-number-of-prediction-steps"></a>
</h2>
<hr>
<p>The number of time steps ahead that predictions are desired can be
changed with the <code>k.ahead</code> argument. The default behaviour is
to save all prediction steps from 1 to <code>k.ahead</code> but if only
a selected few are desired, then the <code>return.k.ahead</code>
argument can be used to indicate which should be kept in the output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred1</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pred2</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">10</span>, return.k.ahead<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred1</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   i. j.  t.i  t.j k.ahead        x       var.x</span></span>
<span><span class="co">## 1  0  0 0.00 0.00       0 3.000000 0.100000000</span></span>
<span><span class="co">## 2  0  1 0.00 0.01       1 2.853688 0.090578913</span></span>
<span><span class="co">## 3  0  2 0.00 0.02       2 2.714512 0.082054359</span></span>
<span><span class="co">## 4  1  1 0.01 0.01       0 2.704116 0.009005756</span></span>
<span><span class="co">## 5  1  2 0.01 0.02       1 2.572235 0.008243908</span></span>
<span><span class="co">## 6  1  3 0.01 0.03       2 2.446786 0.007554560</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred2</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    i. j.  t.i  t.j k.ahead        x       var.x</span></span>
<span><span class="co">## 3   0  2 0.00 0.02       2 2.714512 0.082054359</span></span>
<span><span class="co">## 6   0  5 0.00 0.05       5 2.336402 0.061046563</span></span>
<span><span class="co">## 9   0  8 0.00 0.08       8 2.010960 0.045483600</span></span>
<span><span class="co">## 14  1  3 0.01 0.03       2 2.446786 0.007554560</span></span>
<span><span class="co">## 17  1  6 0.01 0.06       5 2.105968 0.005855739</span></span>
<span><span class="co">## 20  1  9 0.01 0.09       8 1.812623 0.004597221</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="set-the-model-parameters-used">Set the model parameters used<a class="anchor" aria-label="anchor" href="#set-the-model-parameters-used"></a>
</h2>
<hr>
<p>The default of <code>predict</code> is to use the initial parameters
supplied during <code>add_parameters</code>, unless the
<code>estimate</code> function has been succesfully run, then
<code>predict</code> will use the parameter values at the found
minimizer. You can provide other parameters using the <code>pars</code>
argument of the method i.e.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some.other.random.pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">par.fixed</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, pars<span class="op">=</span><span class="va">some.other.random.pars</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-the-initial-state-and-covariance">Set the initial state and covariance<a class="anchor" aria-label="anchor" href="#set-the-initial-state-and-covariance"></a>
</h2>
<hr>
<p>The default behaviour of <code>predict</code> is to use the initial
state and covariance suppled when calling the
<code>set_initial_state</code> method. This can be important to change
if one wishes to correctly predict on the first few observations in a
provided prediction data series. You can supply the <code>x0</code> and
<code>p0</code> arguments with updated state and covariance
estimates</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new.initial.x0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">new.initial.p0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>data<span class="op">=</span><span class="va">.data</span>,</span>
<span>                   initial.state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                     <span class="va">new.state.value</span>,</span>
<span>                     <span class="va">new.covariance.value</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-solver-options">The solver options<a class="anchor" aria-label="anchor" href="#the-solver-options"></a>
</h2>
<hr>
<p>You can choose which solver options to use via the arguments
<code>ode.solver</code> and <code>ode.timestep</code>.</p>
<p>The <code>ode.solver</code> decides which ode solver algorithm to
used when solving the mean and variance ODEs of the SDE.</p>
<p>The <code>ode.timestep</code> determines the time step-size using
when solving the ODEs, with default value being the minimum observed
time difference in the provided data time vector
(<code>min(diff(.data$t))</code>). The time step-size can’t be smaller
than this. If the chosen time step-size <span class="math inline">\(\Delta_{step}\)</span> does not “almost” divide
the observation time differences in the data <span class="math inline">\(\Delta_{obs}\)</span> i.e. if <span class="math display">\[
\frac{\Delta_{obs}}{\Delta_{step}} - \bigg\lfloor
\frac{\Delta_{obs}}{\Delta_{step}} \bigg\rfloor \geq 0.02
\]</span> then the time step-size is reduced such that it does divide
evenly by setting</p>
<p><span class="math display">\[
\frac{\Delta_{obs}}{\Delta_{step}} = \bigg\lceil
\frac{\Delta_{obs}}{\Delta_{step}} \bigg\rceil
\]</span> In other words: if there it takes <span class="math inline">\(3.561\)</span> time-steps to get from <span class="math inline">\(t_{i}\)</span> to <span class="math inline">\(t_{i+1}\)</span> then we take <span class="math inline">\(4\)</span> time-steps instead, and calculate a
reduced time-step such that this is true. If there were only <span class="math inline">\(3.01\)</span> time-steps then we retain the
original time-step, ignoring the small temporal discrepancy.</p>
<p>We provide these arguments via</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>,</span>
<span>            ode.timestep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-case">Use-case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<hr>
<p>We could use our model predictions against observation to compute a
model performance score e.g. RMSE (root-mean square error). We first
estimate the model parameters, such that they are automatically used
when calling <code>predict</code>. We then predict up to 10-steps ahead,
and return only these values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">estimate</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">pred.states</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">states</span></span>
<span><span class="va">pred.obs</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">observations</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot2 theme</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">mytheme</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text             <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="st">"Avenir Next Condensed"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    legend.text      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.text        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    strip.text       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    legend.box       <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>    legend.position  <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    plot.title       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Let’s plot the 10-step predictions against the observations.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred10</span> <span class="op">=</span> <span class="va">pred.states</span><span class="op">[</span><span class="va">pred.states</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="va">.data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">t.j</span>,y<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span>,color<span class="op">=</span><span class="st">"10-Step Predictions"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">t.j</span>,ymin<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred10</span><span class="op">$</span><span class="va">var.x</span><span class="op">)</span>,ymax<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred10</span><span class="op">$</span><span class="va">var.x</span><span class="op">)</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"grey"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">t</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,color<span class="op">=</span><span class="st">"Observations"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="st">"Time"</span>,y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># coord_cartesian(xlim=c(0,0.1)) +</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-16-1.png" width="700">
We notice that because these are 10-step predictions the state
uncertainty (95%) is much larger than for the filtered posterior state
estimates from <code>fit</code> i.e.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span>         <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="va">xpost</span>     <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">xpost_sd</span>  <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">sd</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">x</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,y<span class="op">=</span><span class="va">xpost</span>,color<span class="op">=</span><span class="st">"0-Step Predictions (Posterior State Estimates)"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,ymin<span class="op">=</span><span class="va">xpost</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span>,ymax<span class="op">=</span><span class="va">xpost</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"grey"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">t</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,color<span class="op">=</span><span class="st">"Observations"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">""</span>, color<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-17-1.png" width="700">
We can calculate the RMSE prediction score for each prediction step as
follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">k.ahead</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">k.ahead</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">xy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">pred.states</span><span class="op">[</span><span class="va">pred.states</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="va">i</span>,<span class="st">"x"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pred.obs</span><span class="op">[</span><span class="va">pred.obs</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="va">i</span>,<span class="st">"y.data"</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">rmse</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">xy</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">k.ahead</span>, <span class="va">rmse</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">k.ahead</span>, <span class="va">rmse</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Root-Mean Square Errors for Different Prediction Horizons"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Prediction Steps"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Root-Mean-Square Errors"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Phillip Vetter.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
