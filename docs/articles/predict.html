<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sdeTMB">
<title>predict: Forecasting the model states and observations. • sdeTMB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Mukta-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="predict: Forecasting the model states and observations.">
<meta property="og:description" content="sdeTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sdeTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sdeTMB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/construct_nll.html">construct_nll: How to extract function handlers, and choosing your own optimizer</a>
    <a class="dropdown-item" href="../articles/estimate.html">estimate: Estimating model parameters and states</a>
    <a class="dropdown-item" href="../articles/observation_equations.html">observations: Using functions on the left-hand side</a>
    <a class="dropdown-item" href="../articles/predict.html">predict: Forecasting the model states and observations.</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phillipbvetter/sdeTMB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>predict: Forecasting the model states and observations.</h1>
                        <h4 data-toc-skip class="author"></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phillipbvetter/sdeTMB/blob/HEAD/vignettes/predict.Rmd" class="external-link"><code>vignettes/predict.Rmd</code></a></small>
      <div class="d-none name"><code>predict.Rmd</code></div>
    </div>

    
    
<p>We demonstate how to use the <code>predict</code> method to obtain
k-step ahead predictions / forecasts of a model object, and the
observations.</p>
<p>A prediction in this context is considered to be a prior estimate of
the state mean and covariance i.e. an estimate obtained without
incorporating information from future observations. We denote these</p>
<p><span class="math display">\[
\hat{x}_{i|j} = \mathrm{E}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}}) \\
\hat{P}_{i|j} = \mathrm{V}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}})
\]</span> where <span class="math inline">\(i \geq j\)</span>.</p>
<p>The <code>predict</code> method computes the predictions depending on
its argument <code>method</code> in the following way:</p>
<ol style="list-style-type: decimal">
<li><p>The Extended Kalman FIlter (<code>method=ekf</code>): The
posterior values <span class="math inline">\(\hat{x}_{i|i}\)</span>,
<span class="math inline">\(\hat{P}_{i|i}\)</span> are obtained from the
filter. In each iteration the moment ODEs <span class="math display">\[
\begin{align}
\frac{d\hat{x}_{i|i}}{dt} &amp;= f(\hat{x}_{i|i},\cdots) \\
\frac{d\hat{P}_{i|i}}{dt} &amp;=
\left[\frac{df}{dx}(\hat{x}_{i|i},\cdots)\right] \hat{P}_{i|i} +
\hat{P}_{i|i} \left[\frac{df}{dx}(\hat{x}_{i|i},\cdots)\right]^{T} +
G(\hat{x}_{i|i},\cdots)G^{T}(\hat{x}_{i|i},\cdots)
\end{align}
\]</span> are solved from the initial time <span class="math inline">\(t_{i}\)</span> until <span class="math inline">\(t_{j}\)</span> where the number of steps is
determined by the argument <code>k.ahead</code> to <code>predict</code>,
i.e. <code>j=i+k.ahead</code>. The solution at each time point <span class="math inline">\(t_{i+1}, t_{i+2}, \dots, t_{i+k.ahead}\)</span> is
the desired predictions. We note that these predictions assume that the
underlying probability density of the SDE remains approximately
Gaussian. If the prediction horizon is large then this assumption
probably doesn’t hold, and one should instead use stochastic predictions
via the argument <code>stochastic=TRUE</code>. The stochastic
predictions are generated by simulating the SDE forward in time many
times using an Euler-Maruyama scheme and reporting back quantiles of the
emperical distribution.</p></li>
<li><p>The Laplace Approximation (<code>method=tmb</code>): The
<code>predict</code> method is not yet implemented.</p></li>
</ol>
<div class="section level2">
<h2 id="simulate-from-the-ornstein-uhlenbeck-process">Simulate from the Ornstein-Uhlenbeck process<a class="anchor" aria-label="anchor" href="#simulate-from-the-ornstein-uhlenbeck-process"></a>
</h2>
<hr>
<p>We use the Ornstein-Uhlenbeck process again.</p>
<p><span class="math display">\[
\mathrm{d}X_{t} = \theta (\mu - X_{t}) \, \mathrm{d}t \, + \sigma_{X} \,
\mathrm{d}B_{t}
\]</span></p>
<p><span class="math display">\[
Y_{t_{k}} = X_{t_{k}} + e_{t_{k}}, \qquad e_{t_{k}} \sim
\mathcal{N}\left(0,\sigma_{Y}^{2}\right)  
\]</span> We first create data by simulating the process</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data using Euler Maruyama</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">theta</span><span class="op">=</span><span class="fl">10</span>; <span class="va">mu</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_x</span><span class="op">=</span><span class="fl">1</span>; <span class="va">sigma_y</span><span class="op">=</span><span class="fl">1e-1</span></span>
<span><span class="co"># </span></span>
<span><span class="va">dt.sim</span> <span class="op">=</span> <span class="fl">1e-3</span></span>
<span><span class="va">t.sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.sim</span><span class="op">)</span></span>
<span><span class="va">dw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt.sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">*</span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">dt.sim</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract observations and add noise</span></span>
<span><span class="va">dt.obs</span> <span class="op">=</span> <span class="fl">1e-2</span></span>
<span><span class="va">t.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="va">dt.obs</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">t.sim</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">t.obs</span><span class="op">]</span> <span class="op">+</span> <span class="va">sigma_y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data</span></span>
<span><span class="va">.data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="va">t.obs</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-model-object">Construct model object<a class="anchor" aria-label="anchor" href="#construct-model-object"></a>
</h2>
<hr>
<p>We now construct the <code>sdeTMB</code> model object</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create model object</span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="va"><a href="../reference/sdeTMB.html">sdeTMB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set name of model (and the created .cpp file)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">set_modelname</span><span class="op">(</span><span class="st">"ornstein_uhlenbeck"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add system equations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_systems</span><span class="op">(</span></span>
<span>  <span class="va">dx</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add observation equations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set observation equation variances</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_observation_variances</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">sigma_y</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify algebraic relations</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_algebraics</span><span class="op">(</span></span>
<span>  <span class="va">theta</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logtheta</span><span class="op">)</span>,</span>
<span>  <span class="va">sigma_x</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logsigma_x</span><span class="op">)</span>,</span>
<span>  <span class="va">sigma_y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logsigma_y</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify parameter initial values and lower/upper bounds in estimation</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">add_parameters</span><span class="op">(</span></span>
<span>  logtheta   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">5</span>,    lower <span class="op">=</span> <span class="fl">0</span>,    upper <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mu         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    initial <span class="op">=</span> <span class="fl">0</span>,    lower <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,  upper <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  logsigma_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  logsigma_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1e-1</span>, lower <span class="op">=</span> <span class="fl">1e-5</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial state mean and covariance</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">set_initial_state</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1e-1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predict">Predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h2>
<hr>
<p>We can use the predict function without having called
<code>estimate</code> first, in which case the initial value of the
parameters provided during <code>add_parameters</code> are used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code>predict</code> is a list of two data.frames, one
for states and one for observations. The two data.frames share the same
five initial columns that contain indices <code>i</code> and
<code>j</code>, associated time-points <code>t.i</code> and
<code>t.j</code>, and a <code>k.ahead</code></p>
<p>They both contain indices, time-points and associated k-step ahead ,
state/observation values and associated standard deviations, and
observations provided in the data, and predicted observation values
based from the predicted state values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">$</span><span class="va">states</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   i. j.  t.i  t.j k.ahead        x       var.x</span></span>
<span><span class="co">## 1  0  0 0.00 0.00       0 3.000000 0.100000000</span></span>
<span><span class="co">## 2  0  1 0.00 0.01       1 2.853688 0.090578913</span></span>
<span><span class="co">## 3  1  1 0.01 0.01       0 2.704116 0.009005756</span></span>
<span><span class="co">## 4  1  2 0.01 0.02       1 2.572235 0.008243908</span></span>
<span><span class="co">## 5  2  2 0.02 0.02       0 2.600410 0.004518718</span></span>
<span><span class="co">## 6  2  3 0.02 0.03       1 2.473587 0.004183868</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">$</span><span class="va">observations</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     i. j.  t.i  t.j k.ahead        y   y.data</span></span>
<span><span class="co">## 1    0  0 0.00 0.00       0 3.000000 3.105001</span></span>
<span><span class="co">## 2    0  1 0.00 0.01       1 2.853688 2.687603</span></span>
<span><span class="co">## 2.1  1  1 0.01 0.01       0 2.704116 2.687603</span></span>
<span><span class="co">## 3    1  2 0.01 0.02       1 2.572235 2.634588</span></span>
<span><span class="co">## 3.1  2  2 0.02 0.02       0 2.600410 2.634588</span></span>
<span><span class="co">## 4    2  3 0.02 0.03       1 2.473587 2.267096</span></span></code></pre>
<p>The indices <code>i.</code> and <code>j.</code> in the table refer to
expectation and variance of the state vector <span class="math display">\[
\mathrm{E}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}}) \\
\mathrm{V}(x_{t_{i}} | x_{t_{j}}, y_{t_{j}})
\]</span> where the moments are given at indices <span class="math inline">\(i\)</span> (time <span class="math inline">\(t_{i}\)</span>) conditioned on the information
available up until indices <span class="math inline">\(j\)</span> (time
<span class="math inline">\(t_{j}\)</span>). In this sense the
state/covariance predictions with <span class="math inline">\(i=j\)</span> are posterior estimates, and all
others are prior estimates.</p>
<p>By default only the standard deviations of the states are returned.
The entire covariance matrix elements can be returned via</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, return.covariance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-number-of-prediction-steps">Set number of prediction steps<a class="anchor" aria-label="anchor" href="#set-number-of-prediction-steps"></a>
</h2>
<hr>
<p>The number of time steps ahead that predictions are desired can be
changed with the <code>k.ahead</code> argument. The default behaviour is
to save all prediction steps from 1 to <code>k.ahead</code> but if only
a selected few are desired, then the <code>return.k.ahead</code>
argument can be used to indicate which should be kept in the output.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred1</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pred2</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">10</span>, return.k.ahead<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred1</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   i. j.  t.i  t.j k.ahead        x       var.x</span></span>
<span><span class="co">## 1  0  0 0.00 0.00       0 3.000000 0.100000000</span></span>
<span><span class="co">## 2  0  1 0.00 0.01       1 2.853688 0.090578913</span></span>
<span><span class="co">## 3  0  2 0.00 0.02       2 2.714512 0.082054359</span></span>
<span><span class="co">## 4  1  1 0.01 0.01       0 2.704116 0.009005756</span></span>
<span><span class="co">## 5  1  2 0.01 0.02       1 2.572235 0.008243908</span></span>
<span><span class="co">## 6  1  3 0.01 0.03       2 2.446786 0.007554560</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred2</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    i. j.  t.i  t.j k.ahead        x       var.x</span></span>
<span><span class="co">## 3   0  2 0.00 0.02       2 2.714512 0.082054359</span></span>
<span><span class="co">## 6   0  5 0.00 0.05       5 2.336402 0.061046563</span></span>
<span><span class="co">## 9   0  8 0.00 0.08       8 2.010960 0.045483600</span></span>
<span><span class="co">## 14  1  3 0.01 0.03       2 2.446786 0.007554560</span></span>
<span><span class="co">## 17  1  6 0.01 0.06       5 2.105968 0.005855739</span></span>
<span><span class="co">## 20  1  9 0.01 0.09       8 1.812623 0.004597221</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="set-the-model-parameters-used">Set the model parameters used<a class="anchor" aria-label="anchor" href="#set-the-model-parameters-used"></a>
</h2>
<hr>
<p>The default of <code>predict</code> is to use the initial parameters
supplied during <code>add_parameters</code>, unless the
<code>estimate</code> function has been succesfully run, then
<code>predict</code> will use the parameter values at the found
minimizer. You can provide other parameters using the <code>pars</code>
argument of the method i.e.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some.other.random.pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">par.fixed</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, pars<span class="op">=</span><span class="va">some.other.random.pars</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-the-initial-state-and-covariance">Set the initial state and covariance<a class="anchor" aria-label="anchor" href="#set-the-initial-state-and-covariance"></a>
</h2>
<hr>
<p>The default behaviour of <code>predict</code> is to use the initial
state and covariance suppled when calling the
<code>set_initial_state</code> method. This can be important to change
if one wishes to correctly predict on the first few observations in a
provided prediction data series. You can supply the <code>x0</code> and
<code>p0</code> arguments with updated state and covariance
estimates</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new.initial.x0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">new.initial.p0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>data<span class="op">=</span><span class="va">.data</span>,</span>
<span>                   initial.state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                     <span class="va">new.state.value</span>,</span>
<span>                     <span class="va">new.covariance.value</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-solver-options">The solver options<a class="anchor" aria-label="anchor" href="#the-solver-options"></a>
</h2>
<hr>
<p>You can choose which solver options to use via the arguments
<code>ode.solver</code> and <code>ode.timestep</code>.</p>
<p>The <code>ode.solver</code> decides which ode solver algorithm to
used when solving the mean and variance ODEs of the SDE.</p>
<p>The <code>ode.timestep</code> determines the time step-size using
when solving the ODEs, with default value being the minimum observed
time difference in the provided data time vector
(<code>min(diff(.data$t))</code>). The time step-size can’t be smaller
than this. If the chosen time step-size <span class="math inline">\(\Delta_{step}\)</span> does not “almost” divide
the observation time differences in the data <span class="math inline">\(\Delta_{obs}\)</span> i.e. if <span class="math display">\[
\frac{\Delta_{obs}}{\Delta_{step}} - \bigg\lfloor
\frac{\Delta_{obs}}{\Delta_{step}} \bigg\rfloor \geq 0.02
\]</span> then the time step-size is reduced such that it does divide
evenly by setting</p>
<p><span class="math display">\[
\frac{\Delta_{obs}}{\Delta_{step}} = \bigg\lceil
\frac{\Delta_{obs}}{\Delta_{step}} \bigg\rceil
\]</span> In other words: if there it takes <span class="math inline">\(3.561\)</span> time-steps to get from <span class="math inline">\(t_{i}\)</span> to <span class="math inline">\(t_{i+1}\)</span> then we take <span class="math inline">\(4\)</span> time-steps instead, and calculate a
reduced time-step such that this is true. If there were only <span class="math inline">\(3.01\)</span> time-steps then we retain the
original time-step, ignoring the small temporal discrepancy.</p>
<p>We provide these arguments via</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>,</span>
<span>            ode.timestep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-case">Use-case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<hr>
<p>We could use our model predictions against observation to compute a
model performance score e.g. RMSE (root-mean square error). We first
estimate the model parameters, such that they are automatically used
when calling <code>predict</code>. We then predict up to 10-steps ahead,
and return only these values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">estimate</span><span class="op">(</span><span class="va">.data</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">.data</span>, k.ahead<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">pred.states</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">states</span></span>
<span><span class="va">pred.obs</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">observations</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot2 theme</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">mytheme</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text             <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="st">"Avenir Next Condensed"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    legend.text      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.text        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    strip.text       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>,size<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    legend.box       <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>    legend.position  <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    plot.title       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Let’s plot the 10-step predictions against the observations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred10</span> <span class="op">=</span> <span class="va">pred.states</span><span class="op">[</span><span class="va">pred.states</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="va">.data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">t.j</span>,y<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span>,color<span class="op">=</span><span class="st">"10-Step Predictions"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">t.j</span>,ymin<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred10</span><span class="op">$</span><span class="va">var.x</span><span class="op">)</span>,ymax<span class="op">=</span><span class="va">pred10</span><span class="op">$</span><span class="va">x</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred10</span><span class="op">$</span><span class="va">var.x</span><span class="op">)</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"grey"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">t</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,color<span class="op">=</span><span class="st">"Observations"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="st">"Time"</span>,y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># coord_cartesian(xlim=c(0,0.1)) +</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-16-1.png" width="700">
We notice that because these are 10-step predictions the state
uncertainty (95%) is much larger than for the filtered posterior state
estimates from <code>fit</code> i.e.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span>         <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="va">xpost</span>     <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">xpost_sd</span>  <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">sd</span><span class="op">$</span><span class="va">posterior</span><span class="op">$</span><span class="va">x</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,y<span class="op">=</span><span class="va">xpost</span>,color<span class="op">=</span><span class="st">"0-Step Predictions (Posterior State Estimates)"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,ymin<span class="op">=</span><span class="va">xpost</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span>,ymax<span class="op">=</span><span class="va">xpost</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xpost_sd</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"grey"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">t</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,color<span class="op">=</span><span class="st">"Observations"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">""</span>, color<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-17-1.png" width="700">
We can calculate the RMSE prediction score for each prediction step as
follows:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">k.ahead</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">k.ahead</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">xy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">pred.states</span><span class="op">[</span><span class="va">pred.states</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="va">i</span>,<span class="st">"x"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pred.obs</span><span class="op">[</span><span class="va">pred.obs</span><span class="op">$</span><span class="va">k.ahead</span><span class="op">==</span><span class="va">i</span>,<span class="st">"y.data"</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">rmse</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">xy</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">k.ahead</span>, <span class="va">rmse</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">k.ahead</span>, <span class="va">rmse</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Root-Mean Square Errors for Different Prediction Horizons"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Prediction Steps"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Root-Mean-Square Errors"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span></span></code></pre></div>
<p><img src="predict_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phillip Vetter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
